<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Regression as Mean- and Covariance-Structure Analysis | A lavaan Compendium for Structural Equation Modeling in Educational Research</title>
  <meta name="description" content="1 Regression as Mean- and Covariance-Structure Analysis | A lavaan Compendium for Structural Equation Modeling in Educational Research" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Regression as Mean- and Covariance-Structure Analysis | A lavaan Compendium for Structural Equation Modeling in Educational Research" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="TDJorgensen/SEM-in-Ed-compendium" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Regression as Mean- and Covariance-Structure Analysis | A lavaan Compendium for Structural Equation Modeling in Educational Research" />
  
  
  

<meta name="author" content="Suzanne Jak and Terrence D. Jorgensen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="ch2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#copyright"><i class="fa fa-check"></i>Copyright</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ch1.html"><a href="ch1.html"><i class="fa fa-check"></i><b>1</b> Regression as Mean- and Covariance-Structure Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch1.html"><a href="ch1.html#what-are-mean-and-covariance-structures"><i class="fa fa-check"></i><b>1.1</b> What Are Mean and Covariance <em>Structures</em>?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="ch1.html"><a href="ch1.html#ch1-1-1"><i class="fa fa-check"></i><b>1.1.1</b> Types of Data Used in SEM</a></li>
<li class="chapter" data-level="1.1.2" data-path="ch1.html"><a href="ch1.html#interpreting-covariance"><i class="fa fa-check"></i><b>1.1.2</b> Interpreting Covariance</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ch1.html"><a href="ch1.html#importing-data-for-sem"><i class="fa fa-check"></i><b>1.2</b> Importing Data for SEM</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ch1.html"><a href="ch1.html#installing-lavaan"><i class="fa fa-check"></i><b>1.2.1</b> Installing <code>lavaan</code></a></li>
<li class="chapter" data-level="1.2.2" data-path="ch1.html"><a href="ch1.html#importing-raw-data"><i class="fa fa-check"></i><b>1.2.2</b> Importing Raw Data</a></li>
<li class="chapter" data-level="1.2.3" data-path="ch1.html"><a href="ch1.html#calculate-summary-statistics-from-raw-data"><i class="fa fa-check"></i><b>1.2.3</b> Calculate Summary Statistics from Raw Data</a></li>
<li class="chapter" data-level="1.2.4" data-path="ch1.html"><a href="ch1.html#importing-summary-data"><i class="fa fa-check"></i><b>1.2.4</b> Importing Summary Data</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ch1.html"><a href="ch1.html#regression-using-matrix-algebra"><i class="fa fa-check"></i><b>1.3</b> Regression Using Matrix Algebra</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ch1.html"><a href="ch1.html#ch1-3-1"><i class="fa fa-check"></i><b>1.3.1</b> Linear Regression Models</a></li>
<li class="chapter" data-level="1.3.2" data-path="ch1.html"><a href="ch1.html#intercepts-and-means"><i class="fa fa-check"></i><b>1.3.2</b> Intercepts and Means</a></li>
<li class="chapter" data-level="1.3.3" data-path="ch1.html"><a href="ch1.html#categorical-predictors"><i class="fa fa-check"></i><b>1.3.3</b> Categorical Predictors</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ch1.html"><a href="ch1.html#summary"><i class="fa fa-check"></i><b>1.4</b> Summary</a></li>
<li class="chapter" data-level="" data-path="ch1.html"><a href="ch1.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch2.html"><a href="ch2.html"><i class="fa fa-check"></i><b>2</b> Using <code>lavaan</code> to Run Regression and ANOVA as a SEM</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch2.html"><a href="ch2.html#prepare-data-and-workspace"><i class="fa fa-check"></i><b>2.1</b> Prepare Data and Workspace</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ch2.html"><a href="ch2.html#import-example-data"><i class="fa fa-check"></i><b>2.1.1</b> Import Example Data</a></li>
<li class="chapter" data-level="2.1.2" data-path="ch2.html"><a href="ch2.html#ch2-1-2"><i class="fa fa-check"></i><b>2.1.2</b> <code>lavaan</code> Syntax</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ch2.html"><a href="ch2.html#comparing-2-group-means-in-glm-and-sem"><i class="fa fa-check"></i><b>2.2</b> Comparing 2 Group Means in GLM and SEM</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch2.html"><a href="ch2.html#the-glm-approach"><i class="fa fa-check"></i><b>2.2.1</b> The GLM Approach</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch2.html"><a href="ch2.html#the-sem-approach-single-group-sem"><i class="fa fa-check"></i><b>2.2.2</b> The SEM Approach (single-group SEM)</a></li>
<li class="chapter" data-level="2.2.3" data-path="ch2.html"><a href="ch2.html#multigroup-sem-approach"><i class="fa fa-check"></i><b>2.2.3</b> Multigroup SEM Approach</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch2.html"><a href="ch2.html#fit-an-sem-to-summary-statistics"><i class="fa fa-check"></i><b>2.3</b> Fit an SEM to Summary Statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ch2.html"><a href="ch2.html#advantages-of-analyzing-summary-statistics"><i class="fa fa-check"></i><b>2.3.1</b> Advantages of Analyzing Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch2.html"><a href="ch2.html#moderation-in-sem"><i class="fa fa-check"></i><b>2.4</b> Moderation in SEM</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ch2.html"><a href="ch2.html#moderation-by-groups-using-mg-sem"><i class="fa fa-check"></i><b>2.4.1</b> Moderation by Groups Using MG-SEM</a></li>
<li class="chapter" data-level="2.4.2" data-path="ch2.html"><a href="ch2.html#the-emmeans-package"><i class="fa fa-check"></i><b>2.4.2</b> The <code>emmeans</code> Package</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ch2.html"><a href="ch2.html#summary-1"><i class="fa fa-check"></i><b>2.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#references-1"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch3.html"><a href="ch3.html"><i class="fa fa-check"></i><b>3</b> Path Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch3.html"><a href="ch3.html#illustrative-example"><i class="fa fa-check"></i><b>3.1</b> Illustrative example</a></li>
<li class="chapter" data-level="3.2" data-path="ch3.html"><a href="ch3.html#conceptual-explanation"><i class="fa fa-check"></i><b>3.2</b> Conceptual explanation</a></li>
<li class="chapter" data-level="3.3" data-path="ch3.html"><a href="ch3.html#matrix-explanation"><i class="fa fa-check"></i><b>3.3</b> Matrix explanation</a></li>
<li class="chapter" data-level="3.4" data-path="ch3.html"><a href="ch3.html#path-analysis-using-lavaan"><i class="fa fa-check"></i><b>3.4</b> Path analysis using lavaan</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ch3.html"><a href="ch3.html#installing-lavaan-1"><i class="fa fa-check"></i><b>3.4.1</b> Installing lavaan</a></li>
<li class="chapter" data-level="3.4.2" data-path="ch3.html"><a href="ch3.html#fitting-a-path-model"><i class="fa fa-check"></i><b>3.4.2</b> Fitting a path model</a></li>
<li class="chapter" data-level="3.4.3" data-path="ch3.html"><a href="ch3.html#syntax-shortcuts"><i class="fa fa-check"></i><b>3.4.3</b> Syntax shortcuts</a></li>
<li class="chapter" data-level="3.4.4" data-path="ch3.html"><a href="ch3.html#extracting-results-from-lavaan-output-in-matrix-form"><i class="fa fa-check"></i><b>3.4.4</b> Extracting results from lavaan output in matrix form</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#references-2"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#appendix"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#derivations-of-equation-refeq3-08"><i class="fa fa-check"></i>Derivations of Equation @ref(eq:3-08)</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#derivations-of-equation-refeq3-09"><i class="fa fa-check"></i>Derivations of Equation @ref(eq:3-09)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch4.html"><a href="ch4.html"><i class="fa fa-check"></i><b>4</b> Standard Errors and Confidence Intervals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch4.html"><a href="ch4.html#standard-errors"><i class="fa fa-check"></i><b>4.1</b> Standard Errors</a></li>
<li class="chapter" data-level="4.2" data-path="ch4.html"><a href="ch4.html#confidence-intervals"><i class="fa fa-check"></i><b>4.2</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ch4.html"><a href="ch4.html#likelihood-based-confidence-intervals"><i class="fa fa-check"></i><b>4.2.1</b> Likelihood-based confidence intervals</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch4.html"><a href="ch4.html#bootstrapped-confidence-intervals"><i class="fa fa-check"></i><b>4.2.2</b> Bootstrapped confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ch4.html"><a href="ch4.html#obtaining-standard-errors-and-confidence-intervals-in-lavaan"><i class="fa fa-check"></i><b>4.3</b> Obtaining standard errors and confidence intervals in <code>lavaan</code></a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#references-3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch5.html"><a href="ch5.html"><i class="fa fa-check"></i><b>5</b> Direct, Indirect, and Total Effects</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch5.html"><a href="ch5.html#testing-significance-of-indirect-effects"><i class="fa fa-check"></i><b>5.1</b> Testing significance of indirect effects</a></li>
<li class="chapter" data-level="5.2" data-path="ch5.html"><a href="ch5.html#higher-order-indirect-effects"><i class="fa fa-check"></i><b>5.2</b> Higher order indirect effects</a></li>
<li class="chapter" data-level="5.3" data-path="ch5.html"><a href="ch5.html#using-matrix-algebra-to-calculate-total-total-indirect-and-specific-indirect-effects"><i class="fa fa-check"></i><b>5.3</b> Using matrix algebra to calculate total, total indirect and specific indirect effects</a></li>
<li class="chapter" data-level="5.4" data-path="ch5.html"><a href="ch5.html#calculating-total-total-indirect-and-specific-indirect-effects-using-lavaan-output"><i class="fa fa-check"></i><b>5.4</b> Calculating total, total indirect and specific indirect effects using lavaan output</a></li>
<li class="chapter" data-level="5.5" data-path="ch5.html"><a href="ch5.html#calculating-specific-indirect-effects-in-lavaan"><i class="fa fa-check"></i><b>5.5</b> Calculating specific indirect effects in lavaan</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i><b>6</b> Calculating Standardized Parameter Estimates</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch6.html"><a href="ch6.html#standardized-regression-coefficients"><i class="fa fa-check"></i><b>6.1</b> Standardized regression coefficients</a></li>
<li class="chapter" data-level="6.2" data-path="ch6.html"><a href="ch6.html#standardized-residual-factor-variances-and-covariances"><i class="fa fa-check"></i><b>6.2</b> Standardized residual factor variances and covariances</a></li>
<li class="chapter" data-level="6.3" data-path="ch6.html"><a href="ch6.html#calculating-standardized-coefficients-in-r-using-lavaan-results"><i class="fa fa-check"></i><b>6.3</b> Calculating standardized coefficients in R using lavaan results</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#script-6.1"><i class="fa fa-check"></i>Script 6.1</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ch6.html"><a href="ch6.html#request-standardized-output-with-lavaan"><i class="fa fa-check"></i><b>6.4</b> Request standardized output with lavaan</a></li>
<li class="chapter" data-level="6.5" data-path="ch6.html"><a href="ch6.html#standardizing-indirect-and-total-effects"><i class="fa fa-check"></i><b>6.5</b> Standardizing indirect and total effects</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch7.html"><a href="ch7.html"><i class="fa fa-check"></i><b>7</b> Identification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch7.html"><a href="ch7.html#assessment-of-identification-using-the-elements-of-mathbfsigma_textpopulation-and-mathbfsigma_textmodel"><i class="fa fa-check"></i><b>7.1</b> Assessment of identification using the elements of <span class="math inline">\(\mathbf\Sigma_{\text{population}}\)</span> and <span class="math inline">\(\mathbf\Sigma_{\text{model}}\)</span></a></li>
<li class="chapter" data-level="7.2" data-path="ch7.html"><a href="ch7.html#assessing-identification-through-heuristics-rules-of-thumb"><i class="fa fa-check"></i><b>7.2</b> Assessing identification through heuristics (rules of thumb)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ch7.html"><a href="ch7.html#the-recursive-rule"><i class="fa fa-check"></i><b>7.2.1</b> The recursive rule</a></li>
<li class="chapter" data-level="7.2.2" data-path="ch7.html"><a href="ch7.html#the-order-condition"><i class="fa fa-check"></i><b>7.2.2</b> The order condition</a></li>
<li class="chapter" data-level="7.2.3" data-path="ch7.html"><a href="ch7.html#the-rank-condition"><i class="fa fa-check"></i><b>7.2.3</b> The rank condition</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ch7.html"><a href="ch7.html#assessment-of-empirical-model-identification-using-lavaan"><i class="fa fa-check"></i><b>7.3</b> Assessment of empirical model identification using <code>lavaan</code></a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#script-7.1"><i class="fa fa-check"></i>Script 7.1</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#script-7.2"><i class="fa fa-check"></i>Script 7.2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#appendix-1"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#algebraic-assessment-of-identification-using-elements-of-mathbfsigma_textpopulation-and-mathbfsigma_textmodel"><i class="fa fa-check"></i>Algebraic assessment of identification using elements of <span class="math inline">\(\mathbf\Sigma_{\text{population}}\)</span> and <span class="math inline">\(\mathbf\Sigma_{\text{model}}\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch8.html"><a href="ch8.html"><i class="fa fa-check"></i><b>8</b> Autoregression</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#script-8.1"><i class="fa fa-check"></i>Script 8.1</a></li>
<li class="chapter" data-level="8.1" data-path="ch8.html"><a href="ch8.html#autoregression-models-with-predictors"><i class="fa fa-check"></i><b>8.1</b> Autoregression models with predictors</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#script-8.2"><i class="fa fa-check"></i>Script 8.2</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ch8.html"><a href="ch8.html#cross-lagged-panel-models"><i class="fa fa-check"></i><b>8.2</b> Cross-lagged panel models</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#references-4"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch9.html"><a href="ch9.html"><i class="fa fa-check"></i><b>9</b> Model Specification and Model Identification</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch9.html"><a href="ch9.html#from-theory-to-model"><i class="fa fa-check"></i><b>9.1</b> From theory to model</a></li>
<li class="chapter" data-level="9.2" data-path="ch9.html"><a href="ch9.html#model-parsimony"><i class="fa fa-check"></i><b>9.2</b> Model parsimony</a></li>
<li class="chapter" data-level="9.3" data-path="ch9.html"><a href="ch9.html#a-priori-model-specification"><i class="fa fa-check"></i><b>9.3</b> A priori model specification</a></li>
<li class="chapter" data-level="9.4" data-path="ch9.html"><a href="ch9.html#post-hoc-model-modification"><i class="fa fa-check"></i><b>9.4</b> Post hoc model modification</a></li>
<li class="chapter" data-level="9.5" data-path="ch9.html"><a href="ch9.html#backward-and-forward-specification-searches"><i class="fa fa-check"></i><b>9.5</b> Backward and forward specification searches</a></li>
<li class="chapter" data-level="9.6" data-path="ch9.html"><a href="ch9.html#correlation-residuals"><i class="fa fa-check"></i><b>9.6</b> Correlation residuals</a></li>
<li class="chapter" data-level="9.7" data-path="ch9.html"><a href="ch9.html#modification-indices"><i class="fa fa-check"></i><b>9.7</b> Modification indices</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="ch9.html"><a href="ch9.html#script-9.0"><i class="fa fa-check"></i><b>9.7.1</b> Script 9.0</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="ch9.html"><a href="ch9.html#cross-validation"><i class="fa fa-check"></i><b>9.8</b> Cross-validation</a></li>
<li class="chapter" data-level="9.9" data-path="ch9.html"><a href="ch9.html#calculating-correlation-residuals-in-lavaan"><i class="fa fa-check"></i><b>9.9</b> Calculating correlation residuals in <code>lavaan</code></a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="ch9.html"><a href="ch9.html#requesting-mis-and-sepcs-in-lavaan"><i class="fa fa-check"></i><b>9.9.1</b> Requesting MIs and (S)EPCs in <code>lavaan</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch9.html"><a href="ch9.html#references-5"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch10.html"><a href="ch10.html"><i class="fa fa-check"></i><b>10</b> Estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch10.html"><a href="ch10.html#improper-solutions"><i class="fa fa-check"></i><b>10.1</b> Improper Solutions</a></li>
<li class="chapter" data-level="10.2" data-path="ch10.html"><a href="ch10.html#specifying-starting-values-in-lavaan"><i class="fa fa-check"></i><b>10.2</b> Specifying starting values in lavaan</a></li>
<li class="chapter" data-level="10.3" data-path="ch10.html"><a href="ch10.html#alternative-estimators"><i class="fa fa-check"></i><b>10.3</b> Alternative estimators</a></li>
<li class="chapter" data-level="10.4" data-path="ch10.html"><a href="ch10.html#robust-estimators"><i class="fa fa-check"></i><b>10.4</b> Robust estimators</a></li>
<li class="chapter" data-level="10.5" data-path="ch10.html"><a href="ch10.html#requesting-alternative-and-robust-estimators-in-lavaan"><i class="fa fa-check"></i><b>10.5</b> Requesting alternative and robust estimators in lavaan</a></li>
<li class="chapter" data-level="10.6" data-path="ch10.html"><a href="ch10.html#ch10-6"><i class="fa fa-check"></i><b>10.6</b> Alternative calculation of the ML discrepancy function when analysing raw data</a></li>
<li class="chapter" data-level="10.7" data-path="ch10.html"><a href="ch10.html#ch10-7"><i class="fa fa-check"></i><b>10.7</b> Using FIML to analyse raw data with missing values in lavaan</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#references-6"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch11.html"><a href="ch11.html"><i class="fa fa-check"></i><b>11</b> Measures of Model Fit</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch11.html"><a href="ch11.html#the-chi-squared-test-of-exact-fit"><i class="fa fa-check"></i><b>11.1</b> The chi-squared test of exact fit</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="ch11.html"><a href="ch11.html#alternative-basis-for-calculating-the-test-statistic-when-analysing-raw-data"><i class="fa fa-check"></i><b>11.1.1</b> Alternative basis for calculating the test statistic when analysing raw data</a></li>
<li class="chapter" data-level="11.1.2" data-path="ch11.html"><a href="ch11.html#testing-exact-fit-vs.-describing-the-degree-of-approximate-fit"><i class="fa fa-check"></i><b>11.1.2</b> Testing exact fit vs. describing the degree of approximate fit</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ch11.html"><a href="ch11.html#root-mean-square-error-of-approximation-rmsea"><i class="fa fa-check"></i><b>11.2</b> Root Mean Square Error of Approximation (RMSEA)</a></li>
<li class="chapter" data-level="11.3" data-path="ch11.html"><a href="ch11.html#other-descriptive-fit-indices"><i class="fa fa-check"></i><b>11.3</b> Other descriptive fit indices</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="ch11.html"><a href="ch11.html#the-tuckerlewis-index-tli-and-the-comparative-fit-index-cfi"><i class="fa fa-check"></i><b>11.3.1</b> The Tucker–Lewis Index (TLI) and the Comparative Fit Index (CFI)</a></li>
<li class="chapter" data-level="11.3.2" data-path="ch11.html"><a href="ch11.html#the-root-mean-square-residual-rmr-and-standardized-rmr-srmr"><i class="fa fa-check"></i><b>11.3.2</b> The Root Mean Square Residual (RMR) and Standardized RMR (SRMR)</a></li>
<li class="chapter" data-level="11.3.3" data-path="ch11.html"><a href="ch11.html#information-criteria"><i class="fa fa-check"></i><b>11.3.3</b> Information Criteria</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ch11.html"><a href="ch11.html#a-note-on-using-available-fit-indices"><i class="fa fa-check"></i><b>11.4</b> A note on using available fit indices</a></li>
<li class="chapter" data-level="11.5" data-path="ch11.html"><a href="ch11.html#difference-in-model-fit"><i class="fa fa-check"></i><b>11.5</b> Difference in model fit</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="ch11.html"><a href="ch11.html#deltachi2-as-a-likelihood-ratio-test"><i class="fa fa-check"></i><b>11.5.1</b> <span class="math inline">\(\Delta\chi^2\)</span> as a likelihood ratio test</a></li>
<li class="chapter" data-level="11.5.2" data-path="ch11.html"><a href="ch11.html#describing-differences-in-fit"><i class="fa fa-check"></i><b>11.5.2</b> Describing differences in fit</a></li>
<li class="chapter" data-level="11.5.3" data-path="ch11.html"><a href="ch11.html#testing-differences-in-fit-between-non-nested-models"><i class="fa fa-check"></i><b>11.5.3</b> Testing differences in fit between non-nested models</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="ch11.html"><a href="ch11.html#request-fit-measures-in-lavaan"><i class="fa fa-check"></i><b>11.6</b> Request fit measures in <code>lavaan</code></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="ch11.html"><a href="ch11.html#compare-fit-of-lavaan-models"><i class="fa fa-check"></i><b>11.6.1</b> Compare fit of lavaan models</a></li>
<li class="chapter" data-level="11.6.2" data-path="ch11.html"><a href="ch11.html#fit-measures-in-lavaan-when-adjusting-for-non-normal-data"><i class="fa fa-check"></i><b>11.6.2</b> Fit measures in <code>lavaan</code> when adjusting for non-normal data</a></li>
<li class="chapter" data-level="11.6.3" data-path="ch11.html"><a href="ch11.html#test-statistic-adjusted-for-small-sample-size"><i class="fa fa-check"></i><b>11.6.3</b> Test statistic adjusted for small sample size</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#references-7"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch12.html"><a href="ch12.html"><i class="fa fa-check"></i><b>12</b> Path Analysis with Categorical Outcomes</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch12.html"><a href="ch12.html#prepare-data-and-workspace-1"><i class="fa fa-check"></i><b>12.1</b> Prepare Data and Workspace</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="ch12.html"><a href="ch12.html#import-example-data-1"><i class="fa fa-check"></i><b>12.1.1</b> Import Example Data</a></li>
<li class="chapter" data-level="12.1.2" data-path="ch12.html"><a href="ch12.html#summarize-data"><i class="fa fa-check"></i><b>12.1.2</b> Summarize Data</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="ch12.html"><a href="ch12.html#regression-models-for-binary-variables"><i class="fa fa-check"></i><b>12.2</b> Regression Models for Binary Variables</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ch12.html"><a href="ch12.html#fit-a-logistic-regression-model"><i class="fa fa-check"></i><b>12.2.1</b> Fit a Logistic Regression Model</a></li>
<li class="chapter" data-level="12.2.2" data-path="ch12.html"><a href="ch12.html#fit-a-probit-regression-model"><i class="fa fa-check"></i><b>12.2.2</b> Fit a Probit Regression Model</a></li>
<li class="chapter" data-level="12.2.3" data-path="ch12.html"><a href="ch12.html#compare-models"><i class="fa fa-check"></i><b>12.2.3</b> Compare Models</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch12.html"><a href="ch12.html#latent-response-variable"><i class="fa fa-check"></i><b>12.3</b> Latent Response Variable</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ch12.html"><a href="ch12.html#ordinal-outcomes"><i class="fa fa-check"></i><b>12.3.1</b> Ordinal Outcomes</a></li>
<li class="chapter" data-level="12.3.2" data-path="ch12.html"><a href="ch12.html#estimating-thresholds"><i class="fa fa-check"></i><b>12.3.2</b> Estimating Thresholds</a></li>
<li class="chapter" data-level="12.3.3" data-path="ch12.html"><a href="ch12.html#estimating-polychoric-correlations"><i class="fa fa-check"></i><b>12.3.3</b> Estimating Polychoric Correlations</a></li>
<li class="chapter" data-level="12.3.4" data-path="ch12.html"><a href="ch12.html#estimating-an-sem-with-estimated-input"><i class="fa fa-check"></i><b>12.3.4</b> Estimating an SEM with Estimated Input</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ch12.html"><a href="ch12.html#mediation-model-with-categorical-outcomes"><i class="fa fa-check"></i><b>12.4</b> Mediation Model with Categorical Outcomes</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="ch12.html"><a href="ch12.html#estimate-mediation-models"><i class="fa fa-check"></i><b>12.4.1</b> Estimate Mediation Models</a></li>
<li class="chapter" data-level="12.4.2" data-path="ch12.html"><a href="ch12.html#interpreting-coefficients"><i class="fa fa-check"></i><b>12.4.2</b> Interpreting Coefficients</a></li>
<li class="chapter" data-level="12.4.3" data-path="ch12.html"><a href="ch12.html#delta-vs.-theta-parameterizations"><i class="fa fa-check"></i><b>12.4.3</b> Delta vs. Theta Parameterizations</a></li>
<li class="chapter" data-level="12.4.4" data-path="ch12.html"><a href="ch12.html#decomposing-total-effects"><i class="fa fa-check"></i><b>12.4.4</b> Decomposing Total Effects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch12.html"><a href="ch12.html#references-8"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch13.html"><a href="ch13.html"><i class="fa fa-check"></i><b>13</b> Fitting Path Models with Multilevel Data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch13.html"><a href="ch13.html#intraclass-correlation"><i class="fa fa-check"></i><b>13.1</b> Intraclass correlation</a></li>
<li class="chapter" data-level="13.2" data-path="ch13.html"><a href="ch13.html#multilevel-structure-as-a-nuisance-correcting-for-the-dependency"><i class="fa fa-check"></i><b>13.2</b> Multilevel structure as a nuisance: Correcting for the dependency</a></li>
<li class="chapter" data-level="13.3" data-path="ch13.html"><a href="ch13.html#two-level-path-models"><i class="fa fa-check"></i><b>13.3</b> Two-level path models</a></li>
<li class="chapter" data-level="13.4" data-path="ch13.html"><a href="ch13.html#obtaining-iccs-and-estimates-of-sigma_textw-and-sigma_textb"><i class="fa fa-check"></i><b>13.4</b> Obtaining ICCs, and estimates of <span class="math inline">\(\Sigma_\text{W}\)</span> and <span class="math inline">\(\Sigma_\text{B}\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="ch13.html"><a href="ch13.html#script-13.1"><i class="fa fa-check"></i>Script 13.1</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ch13.html"><a href="ch13.html#fitting-a-two-level-path-model"><i class="fa fa-check"></i><b>13.5</b> Fitting a two-level path model</a>
<ul>
<li class="chapter" data-level="" data-path="ch13.html"><a href="ch13.html#script-13.2"><i class="fa fa-check"></i>Script 13.2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch13.html"><a href="ch13.html#references-9"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ch14.html"><a href="ch14.html"><i class="fa fa-check"></i><b>14</b> Factor Models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ch14.html"><a href="ch14.html#empirical-example-of-a-factor-model"><i class="fa fa-check"></i><b>14.1</b> Empirical example of a factor model</a></li>
<li class="chapter" data-level="14.2" data-path="ch14.html"><a href="ch14.html#conceptual-explanation-of-a-factor-model"><i class="fa fa-check"></i><b>14.2</b> Conceptual explanation of a factor model</a></li>
<li class="chapter" data-level="14.3" data-path="ch14.html"><a href="ch14.html#symbolic-explanation-of-a-factor-model"><i class="fa fa-check"></i><b>14.3</b> Symbolic explanation of a factor model</a></li>
<li class="chapter" data-level="14.4" data-path="ch14.html"><a href="ch14.html#identification-of-model-parameters-in-a-factor-model"><i class="fa fa-check"></i><b>14.4</b> Identification of model parameters in a factor model</a></li>
<li class="chapter" data-level="14.5" data-path="ch14.html"><a href="ch14.html#fitting-a-factor-model-using-lavaan"><i class="fa fa-check"></i><b>14.5</b> Fitting a factor model using lavaan</a>
<ul>
<li class="chapter" data-level="" data-path="ch14.html"><a href="ch14.html#script-14.1"><i class="fa fa-check"></i>Script 14.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch14.html"><a href="ch14.html#references-10"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="ch14.html"><a href="ch14.html#appendix-2"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="ch14.html"><a href="ch14.html#derivations-of-equation-14.13"><i class="fa fa-check"></i>Derivations of Equation 14.13</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ch15.html"><a href="ch15.html"><i class="fa fa-check"></i><b>15</b> Standardized Parameter Estimates for the Factor Model</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ch15.html"><a href="ch15.html#standardized-factor-loadings"><i class="fa fa-check"></i><b>15.1</b> Standardized factor loadings</a></li>
<li class="chapter" data-level="15.2" data-path="ch15.html"><a href="ch15.html#standardized-common-factor-variances-and-covariances"><i class="fa fa-check"></i><b>15.2</b> Standardized common-factor variances and covariances</a></li>
<li class="chapter" data-level="15.3" data-path="ch15.html"><a href="ch15.html#standardized-unique-factor-variances-and-covariances"><i class="fa fa-check"></i><b>15.3</b> Standardized unique-factor variances and covariances</a></li>
<li class="chapter" data-level="15.4" data-path="ch15.html"><a href="ch15.html#structure-coefficients"><i class="fa fa-check"></i><b>15.4</b> Structure coefficients</a></li>
<li class="chapter" data-level="15.5" data-path="ch15.html"><a href="ch15.html#ch15-5"><i class="fa fa-check"></i><b>15.5</b> Calculating standardized coefficients in lavaan</a>
<ul>
<li class="chapter" data-level="" data-path="ch15.html"><a href="ch15.html#script-15.1"><i class="fa fa-check"></i>Script 15.1</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="ch15.html"><a href="ch15.html#request-standardized-output-with-lavaan-1"><i class="fa fa-check"></i><b>15.6</b> Request standardized output with lavaan</a></li>
<li class="chapter" data-level="" data-path="ch15.html"><a href="ch15.html#references-11"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ch16.html"><a href="ch16.html"><i class="fa fa-check"></i><b>16</b> The Empirical Check for Identification</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ch16.html"><a href="ch16.html#empirical-check-of-model-a"><i class="fa fa-check"></i><b>16.1</b> Empirical check of Model A</a>
<ul>
<li class="chapter" data-level="" data-path="ch16.html"><a href="ch16.html#script-16.1"><i class="fa fa-check"></i>Script 16.1</a></li>
<li class="chapter" data-level="" data-path="ch16.html"><a href="ch16.html#script-16.2"><i class="fa fa-check"></i>Script 16.2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch16.html"><a href="ch16.html#references-12"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ch17.html"><a href="ch17.html"><i class="fa fa-check"></i><b>17</b> Second Order Factor Models</a>
<ul>
<li class="chapter" data-level="" data-path="ch17.html"><a href="ch17.html#script-17.1"><i class="fa fa-check"></i>Script 17.1</a></li>
<li class="chapter" data-level="" data-path="ch17.html"><a href="ch17.html#getting-the-parameter-estimates-in-matrix-form"><i class="fa fa-check"></i>Getting the parameter estimates in matrix form</a>
<ul>
<li class="chapter" data-level="" data-path="ch17.html"><a href="ch17.html#script-17.2"><i class="fa fa-check"></i>Script 17.2</a></li>
</ul></li>
<li class="chapter" data-level="17.1" data-path="ch17.html"><a href="ch17.html#standardized-parameter-estimates-for-the-higher-order-part-of-the-model"><i class="fa fa-check"></i><b>17.1</b> Standardized parameter estimates for the higher-order part of the model</a>
<ul>
<li class="chapter" data-level="" data-path="ch17.html"><a href="ch17.html#script-17.3"><i class="fa fa-check"></i>Script 17.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="ch18.html"><a href="ch18.html"><i class="fa fa-check"></i><b>18</b> Structural Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="ch18.html"><a href="ch18.html#script-18.1"><i class="fa fa-check"></i>Script 18.1</a></li>
<li class="chapter" data-level="" data-path="ch18.html"><a href="ch18.html#script-18.2"><i class="fa fa-check"></i>Script 18.2</a></li>
<li class="chapter" data-level="18.1" data-path="ch18.html"><a href="ch18.html#standardized-parameter-estimates-for-the-structural-part-of-the-model"><i class="fa fa-check"></i><b>18.1</b> Standardized parameter estimates for the structural part of the model</a>
<ul>
<li class="chapter" data-level="" data-path="ch18.html"><a href="ch18.html#script-18.3"><i class="fa fa-check"></i>Script 18.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ch19.html"><a href="ch19.html"><i class="fa fa-check"></i><b>19</b> Second-order Correlation Residuals</a></li>
<li class="chapter" data-level="20" data-path="ch20.html"><a href="ch20.html"><i class="fa fa-check"></i><b>20</b> Factors with single indicators</a>
<ul>
<li class="chapter" data-level="" data-path="ch20.html"><a href="ch20.html#script-20.1"><i class="fa fa-check"></i>Script 20.1</a></li>
<li class="chapter" data-level="" data-path="ch20.html"><a href="ch20.html#script-20.2"><i class="fa fa-check"></i>Script 20.2</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="ch21.html"><a href="ch21.html"><i class="fa fa-check"></i><b>21</b> Mean structures</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ch21.html"><a href="ch21.html#mean-structure-of-a-factor-model"><i class="fa fa-check"></i><b>21.1</b> Mean structure of a factor model</a></li>
<li class="chapter" data-level="21.2" data-path="ch21.html"><a href="ch21.html#mean-structure-of-a-path-model"><i class="fa fa-check"></i><b>21.2</b> Mean structure of a path model</a></li>
<li class="chapter" data-level="21.3" data-path="ch21.html"><a href="ch21.html#mean-structure-of-a-factor-model-in-lavaan"><i class="fa fa-check"></i><b>21.3</b> Mean structure of a factor model in <code>lavaan</code></a>
<ul>
<li class="chapter" data-level="" data-path="ch21.html"><a href="ch21.html#script-21.1"><i class="fa fa-check"></i>Script 21.1</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="ch21.html"><a href="ch21.html#mean-structure-of-a-path-model-1"><i class="fa fa-check"></i><b>21.4</b> Mean structure of a path model</a></li>
<li class="chapter" data-level="" data-path="ch21.html"><a href="ch21.html#appendix-3"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="ch21.html"><a href="ch21.html#derivation-of-equation-21.20"><i class="fa fa-check"></i>Derivation of Equation 21.20</a></li>
<li class="chapter" data-level="" data-path="ch21.html"><a href="ch21.html#derivation-of-equation-21.27"><i class="fa fa-check"></i>Derivation of Equation 21.27</a></li>
<li class="chapter" data-level="" data-path="ch21.html"><a href="ch21.html#derivation-of-equation-21.28"><i class="fa fa-check"></i>Derivation of Equation 21.28</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ch22.html"><a href="ch22.html"><i class="fa fa-check"></i><b>22</b> Multigroup Models</a>
<ul>
<li class="chapter" data-level="22.1" data-path="ch22.html"><a href="ch22.html#measurement-invariance"><i class="fa fa-check"></i><b>22.1</b> Measurement invariance</a>
<ul>
<li class="chapter" data-level="" data-path="ch22.html"><a href="ch22.html#script-22.1"><i class="fa fa-check"></i>Script 22.1</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="ch22.html"><a href="ch22.html#across-group-equality-constraints"><i class="fa fa-check"></i><b>22.2</b> Across group equality constraints</a>
<ul>
<li class="chapter" data-level="" data-path="ch22.html"><a href="ch22.html#script-22.2"><i class="fa fa-check"></i>Script 22.2</a></li>
<li class="chapter" data-level="" data-path="ch22.html"><a href="ch22.html#script-22.3"><i class="fa fa-check"></i>Script 22.3</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="ch22.html"><a href="ch22.html#standardized-estimates-for-a-multigroup-model"><i class="fa fa-check"></i><b>22.3</b> Standardized estimates for a multigroup model</a></li>
<li class="chapter" data-level="22.4" data-path="ch22.html"><a href="ch22.html#lavaan-shortcuts"><i class="fa fa-check"></i><b>22.4</b> <code>lavaan</code> shortcuts</a>
<ul>
<li class="chapter" data-level="" data-path="ch22.html"><a href="ch22.html#script-22.4"><i class="fa fa-check"></i>Script 22.4</a></li>
<li class="chapter" data-level="" data-path="ch22.html"><a href="ch22.html#script-22.5"><i class="fa fa-check"></i>Script 22.5</a></li>
<li class="chapter" data-level="" data-path="ch22.html"><a href="ch22.html#script-22.6"><i class="fa fa-check"></i>Script 22.6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ch23.html"><a href="ch23.html"><i class="fa fa-check"></i><b>23</b> Calculating Mean Residuals</a>
<ul>
<li class="chapter" data-level="" data-path="ch23.html"><a href="ch23.html#script-23.1"><i class="fa fa-check"></i>Script 23.1</a></li>
<li class="chapter" data-level="" data-path="ch23.html"><a href="ch23.html#script-22.2-1"><i class="fa fa-check"></i>Script 22.2</a></li>
<li class="chapter" data-level="" data-path="ch23.html"><a href="ch23.html#script-23.3"><i class="fa fa-check"></i>Script 23.3</a></li>
<li class="chapter" data-level="" data-path="ch23.html"><a href="ch23.html#references-13"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="ch24.html"><a href="ch24.html"><i class="fa fa-check"></i><b>24</b> Modification Indices and EPC’s for Equality Constraints</a>
<ul>
<li class="chapter" data-level="24.1" data-path="ch24.html"><a href="ch24.html#modification-index-for-simultaneously-freeing-a-set-of-parameters"><i class="fa fa-check"></i><b>24.1</b> Modification index for simultaneously freeing a set of parameters</a>
<ul>
<li class="chapter" data-level="" data-path="ch24.html"><a href="ch24.html#script-24.1"><i class="fa fa-check"></i>Script 24.1</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="ch24.html"><a href="ch24.html#modification-indices-for-releasing-equality-constraints"><i class="fa fa-check"></i><b>24.2</b> Modification indices for releasing equality constraints</a>
<ul>
<li class="chapter" data-level="" data-path="ch24.html"><a href="ch24.html#script-24.3"><i class="fa fa-check"></i>Script 24.3</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="ch24.html"><a href="ch24.html#epc-interest"><i class="fa fa-check"></i><b>24.3</b> EPC-interest</a></li>
<li class="chapter" data-level="" data-path="ch24.html"><a href="ch24.html#references-14"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="ch25.html"><a href="ch25.html"><i class="fa fa-check"></i><b>25</b> MIMIC (and RFA) models</a>
<ul>
<li class="chapter" data-level="25.1" data-path="ch25.html"><a href="ch25.html#illustration-testing-uniform-bias-in-a-mimic-model"><i class="fa fa-check"></i><b>25.1</b> Illustration testing uniform bias in a MIMIC model</a></li>
<li class="chapter" data-level="25.2" data-path="ch25.html"><a href="ch25.html#evaluating-non-uniform-measurement-bias"><i class="fa fa-check"></i><b>25.2</b> Evaluating non-uniform measurement bias</a></li>
<li class="chapter" data-level="25.3" data-path="ch25.html"><a href="ch25.html#connection-with-measurement-invariance-testing-in-multigroup-models"><i class="fa fa-check"></i><b>25.3</b> Connection with measurement invariance testing in multigroup models</a></li>
<li class="chapter" data-level="25.4" data-path="ch25.html"><a href="ch25.html#rfa-models"><i class="fa fa-check"></i><b>25.4</b> RFA-models</a></li>
<li class="chapter" data-level="" data-path="ch25.html"><a href="ch25.html#references-15"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="ch26.html"><a href="ch26.html"><i class="fa fa-check"></i><b>26</b> Longitudinal Factor Analysis</a>
<ul>
<li class="chapter" data-level="26.1" data-path="ch26.html"><a href="ch26.html#step-1-a-longitudinal-factor-model-with-configural-invariance"><i class="fa fa-check"></i><b>26.1</b> Step 1: A longitudinal factor model with configural invariance</a>
<ul>
<li class="chapter" data-level="" data-path="ch26.html"><a href="ch26.html#script-26.1"><i class="fa fa-check"></i>Script 26.1</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="ch26.html"><a href="ch26.html#step-2-a-longitudinal-model-with-weak-factorial-invariance."><i class="fa fa-check"></i><b>26.2</b> Step 2: A longitudinal model with weak factorial invariance.</a>
<ul>
<li class="chapter" data-level="" data-path="ch26.html"><a href="ch26.html#script-26.2"><i class="fa fa-check"></i>Script 26.2</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="ch26.html"><a href="ch26.html#step-3-longitudinal-model-with-strong-factorial-invariance"><i class="fa fa-check"></i><b>26.3</b> Step 3: Longitudinal model with strong factorial invariance</a>
<ul>
<li class="chapter" data-level="" data-path="ch26.html"><a href="ch26.html#script-26.3"><i class="fa fa-check"></i>Script 26.3</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="ch26.html"><a href="ch26.html#step-4-a-model-with-strict-factorial-invariance"><i class="fa fa-check"></i><b>26.4</b> Step 4: A model with strict factorial invariance</a>
<ul>
<li class="chapter" data-level="" data-path="ch26.html"><a href="ch26.html#script-26.4"><i class="fa fa-check"></i>Script 26.4</a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="ch26.html"><a href="ch26.html#standardized-estimates-for-a-longitudinal-factor-model-with-means"><i class="fa fa-check"></i><b>26.5</b> Standardized estimates for a (longitudinal) factor model with means</a>
<ul>
<li class="chapter" data-level="" data-path="ch26.html"><a href="ch26.html#script-26.5"><i class="fa fa-check"></i>Script 26.5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch26.html"><a href="ch26.html#references-16"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="ch27.html"><a href="ch27.html"><i class="fa fa-check"></i><b>27</b> Latent Growth Curve Models</a>
<ul>
<li class="chapter" data-level="27.1" data-path="ch27.html"><a href="ch27.html#prepare-data-and-workspace-2"><i class="fa fa-check"></i><b>27.1</b> Prepare Data and Workspace</a></li>
<li class="chapter" data-level="27.2" data-path="ch27.html"><a href="ch27.html#random-intercept-model"><i class="fa fa-check"></i><b>27.2</b> Random Intercept Model</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="ch27.html"><a href="ch27.html#specification-and-estimation"><i class="fa fa-check"></i><b>27.2.1</b> Specification and Estimation</a></li>
<li class="chapter" data-level="27.2.2" data-path="ch27.html"><a href="ch27.html#interpret-results"><i class="fa fa-check"></i><b>27.2.2</b> Interpret Results</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="ch27.html"><a href="ch27.html#linear-growth-model"><i class="fa fa-check"></i><b>27.3</b> Linear Growth Model</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="ch27.html"><a href="ch27.html#model-fit-and-comparison"><i class="fa fa-check"></i><b>27.3.1</b> Model Fit and Comparison</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="ch27.html"><a href="ch27.html#unrestricted-growth-models"><i class="fa fa-check"></i><b>27.4</b> Unrestricted Growth Models</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="ch27.html"><a href="ch27.html#latent-basis-curve"><i class="fa fa-check"></i><b>27.4.1</b> Latent Basis Curve</a></li>
<li class="chapter" data-level="27.4.2" data-path="ch27.html"><a href="ch27.html#saturated-growth-model"><i class="fa fa-check"></i><b>27.4.2</b> Saturated Growth Model</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="ch27.html"><a href="ch27.html#explaining-growth-factors"><i class="fa fa-check"></i><b>27.5</b> Explaining Growth Factors</a>
<ul>
<li class="chapter" data-level="27.5.1" data-path="ch27.html"><a href="ch27.html#time-invariant-level-2-predictors"><i class="fa fa-check"></i><b>27.5.1</b> Time-Invariant (Level-2) Predictors</a></li>
<li class="chapter" data-level="27.5.2" data-path="ch27.html"><a href="ch27.html#time-varying-level-1-predictors"><i class="fa fa-check"></i><b>27.5.2</b> Time-Varying (Level-1) Predictors</a></li>
<li class="chapter" data-level="27.5.3" data-path="ch27.html"><a href="ch27.html#parallel-growth-curves"><i class="fa fa-check"></i><b>27.5.3</b> Parallel Growth Curves</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="ch27.html"><a href="ch27.html#latent-indicators-of-growth-factors"><i class="fa fa-check"></i><b>27.6</b> Latent Indicators of Growth Factors</a>
<ul>
<li class="chapter" data-level="27.6.1" data-path="ch27.html"><a href="ch27.html#common-factors"><i class="fa fa-check"></i><b>27.6.1</b> Common Factors</a></li>
<li class="chapter" data-level="27.6.2" data-path="ch27.html"><a href="ch27.html#discrete-indicators"><i class="fa fa-check"></i><b>27.6.2</b> Discrete Indicators</a></li>
</ul></li>
<li class="chapter" data-level="27.7" data-path="ch27.html"><a href="ch27.html#multigroup-growth-models"><i class="fa fa-check"></i><b>27.7</b> Multigroup Growth Models</a></li>
<li class="chapter" data-level="" data-path="ch27.html"><a href="ch27.html#references-17"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="ch28.html"><a href="ch28.html"><i class="fa fa-check"></i><b>28</b> Analysis of categorical outcomes</a>
<ul>
<li class="chapter" data-level="28.1" data-path="ch28.html"><a href="ch28.html#factor-analysis-using-categorical-indicators"><i class="fa fa-check"></i><b>28.1</b> Factor analysis using categorical indicators</a>
<ul>
<li class="chapter" data-level="" data-path="ch28.html"><a href="ch28.html#script-28.1"><i class="fa fa-check"></i>Script 28.1</a></li>
<li class="chapter" data-level="" data-path="ch28.html"><a href="ch28.html#script-28.2"><i class="fa fa-check"></i>Script 28.2</a></li>
<li class="chapter" data-level="" data-path="ch28.html"><a href="ch28.html#script-28.3"><i class="fa fa-check"></i>Script 28.3</a></li>
<li class="chapter" data-level="" data-path="ch28.html"><a href="ch28.html#script-28.4"><i class="fa fa-check"></i>Script 28.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch28.html"><a href="ch28.html#references-and-further-reading"><i class="fa fa-check"></i>References and further reading</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="ch29.html"><a href="ch29.html"><i class="fa fa-check"></i><b>29</b> Fitting CFA models with multilevel data</a>
<ul>
<li class="chapter" data-level="29.1" data-path="ch29.html"><a href="ch29.html#intraclass-correlations-of-observed-variables"><i class="fa fa-check"></i><b>29.1</b> Intraclass correlations of observed variables</a>
<ul>
<li class="chapter" data-level="" data-path="ch29.html"><a href="ch29.html#script-29.1"><i class="fa fa-check"></i>Script 29.1</a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="ch29.html"><a href="ch29.html#multilevel-structure-as-a-nuisance-correcting-for-the-dependency-1"><i class="fa fa-check"></i><b>29.2</b> Multilevel structure as a nuisance: Correcting for the dependency</a></li>
<li class="chapter" data-level="29.3" data-path="ch29.html"><a href="ch29.html#two-level-factor-models"><i class="fa fa-check"></i><b>29.3</b> Two-level factor models</a>
<ul>
<li class="chapter" data-level="" data-path="ch29.html"><a href="ch29.html#script-29.2"><i class="fa fa-check"></i>Script 29.2</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="ch29.html"><a href="ch29.html#intraclass-correlations-of-common-factors"><i class="fa fa-check"></i><b>29.4</b> Intraclass correlations of common factors</a></li>
<li class="chapter" data-level="29.5" data-path="ch29.html"><a href="ch29.html#climate-and-contextual-between-level-latent-variables"><i class="fa fa-check"></i><b>29.5</b> Climate and contextual between-level latent variables</a></li>
<li class="chapter" data-level="29.6" data-path="ch29.html"><a href="ch29.html#full-sem-with-multilevel-data"><i class="fa fa-check"></i><b>29.6</b> Full SEM with multilevel data</a></li>
<li class="chapter" data-level="" data-path="ch29.html"><a href="ch29.html#references-18"><i class="fa fa-check"></i>References</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A <code>lavaan</code> Compendium for Structural Equation Modeling in Educational Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch1" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Regression as Mean- and Covariance-Structure Analysis<a href="ch1.html#ch1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter prepares the reader to learn about structural equation modeling (SEM) by reviewing the fundamentals of ordinary least-squares (OLS) regression in the general(ized) linear modeling (GLM) framework. Different types of data are discussed, and some review of matrix algebra will be incorporated into the regression review.</p>
<div id="what-are-mean-and-covariance-structures" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> What Are Mean and Covariance <em>Structures</em>?<a href="ch1.html#what-are-mean-and-covariance-structures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another (older) name for an SEM is <em>covariance structure analysis</em>. What is meant by this?</p>
<p>Covariance is the linear relationship we observe between 2 variables (more on this below). There might be many reasons why 2 variables covary, such as</p>
<ul>
<li>one variable influences the other</li>
<li>common causes influence them both</li>
<li>both variables appear in a chain or web of causal effects</li>
</ul>
<p>A covariance can be partitioned into components that are due to these different reasons. The decomposition of covariances will be explained after introducing path analysis, but recall how many statistical procedures you may already have learned about, which partition variance into components:</p>
<ul>
<li>Regression: explained (<span class="math inline">\(R^2\)</span>) vs. unexplained (residual) variance</li>
<li>ANOVA: variance between vs. within groups</li>
<li>Multilevel modeling: Level-1 v. -2 variance
<ul>
<li>and (un)explained at each level</li>
</ul></li>
<li>Between vs. within multiple imputations of missing data</li>
</ul>
<p>Regression models in the GLM framework primarily analyze how the mean and variance of the outcome are structured.</p>
<ul>
<li>A grand mean (<span class="math inline">\(\bar{y}\)</span>) is an unconditional expected value, whereas a predicted value from a regression model (<span class="math inline">\(\hat{y}\)</span>) is an expected value under a particular condition (e.g., <span class="math inline">\(\hat{y}=\beta_0\)</span> when <span class="math inline">\(X=0\)</span>). We calculate these conditional expectations as the intercept (<span class="math inline">\(\beta_0\)</span>) plus each predictor times its slope: <span class="math inline">\(\sum \beta_j x_j\)</span>.<br />
</li>
<li>Variance is partitioned into (un)explained variance (e.g., <span class="math inline">\(R^2\)</span>), and its structure can be further explored via unique contributions of each predictor (e.g., partial <span class="math inline">\(\eta^2\)</span> in AN(C)OVA).</li>
</ul>
<p>SEM is a multivariate method capable of partitioning means and variances of each variable, as well as partitioning the covariance between any pair of variables.</p>
<div id="ch1-1-1" class="section level3 hasAnchor" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Types of Data Used in SEM<a href="ch1.html#ch1-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>SEM can be seen as a generalization of the GLM for multivariate data. But rather than merely allowing multiple predictors and multiple outcomes, any variable can operate <strong>both</strong> as a predictor and an outcome in the same model. This allows us to model complex relationships among variables, including chains of causation (i.e., mediation).</p>
<p>Estimation of a GLM involves minimizing discrepancies (differences) between observed (<span class="math inline">\(y\)</span>) and expected (<span class="math inline">\(\hat{y}\)</span>) <em>casewise</em> values (i.e., an individual subject’s score on an outcome variable <span class="math inline">\(y\)</span>). These discrepancies are called “residuals” (<span class="math inline">\(y - \hat{y}\)</span>). In contrast, estimation of a SEM involves minimizing discrepancies between observed and expected <em>summary statistics</em> (i.e., the modeled variables’ means and covariance matrix, see table below). This is why another (older) name for an SEM is <em>covariance structure analysis</em> (when only trying to explain why variables are related to each other), or mean and covariance structure (MACS) analysis when means are also modeled.</p>
<table>
<colgroup>
<col width="15%" />
<col width="22%" />
<col width="30%" />
<col width="32%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center"><strong>Casewise observations</strong> (GLM)</th>
<th align="center"><strong>Mean vector</strong> (SEM)</th>
<th align="center"><strong>Covariance matrix</strong> (SEM)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Observations</td>
<td align="center"><span class="math inline">\(y_i\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}\)</span></td>
<td align="center"><span class="math inline">\(\mathbf{S}\)</span></td>
</tr>
<tr class="even">
<td align="left">Expectations</td>
<td align="center"><span class="math inline">\(\hat{y}_i\)</span></td>
<td align="center"><span class="math inline">\(\widehat{\mu}\)</span></td>
<td align="center"><span class="math inline">\(\widehat{\Sigma}\)</span></td>
</tr>
<tr class="odd">
<td align="left">Residuals</td>
<td align="center"><span class="math inline">\(y_i - \hat{y}_i\)</span></td>
<td align="center"><span class="math inline">\(\bar{y} - \widehat{\mu}\)</span></td>
<td align="center"><span class="math inline">\(\mathbf{S} - \widehat{\Sigma}\)</span></td>
</tr>
</tbody>
</table>
<p>Summary statistics can be calculated from observed raw data, so raw data can be provided directly to SEM software for analysis. But if data are complete and come from a multivariate normal distribution, summary statistics can also be passed directly to the SEM software, which has advantages. Unlike raw data, summary statistics do not compromise the privacy of the research participants, so summary statistics can be reported in published empirical research. That allows research-consumers (like you) to have access to the same summary statistics to replicate the results or to fit a different model (e.g., that represents a competing theory). Thus, this chapter will show how to import both raw and summary data, as well as how to calculate summary statistics from raw data so that they can be reported along with results. First, we provide some information about interpreting the summary statistics most relevant for SEM.</p>
</div>
<div id="interpreting-covariance" class="section level3 hasAnchor" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Interpreting Covariance<a href="ch1.html#interpreting-covariance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Whether in a GLM or as part of a larger SEM, a regression model includes both mean-structure parameters (intercepts) and covariance-structure parameters (slopes, residual variance). Generally speaking, covariance-structure parameters are informative about how variables are related to each other, and even the variances of (and covariances among) predictors are pivotal to estimating regression slopes. In GLM, this is not immediately apparent from regression output, so later in this chapter we will demonstrate how to manually calculate regression slopes from raw data, revealing the role of summary statistics in estimating slopes. But first, <strong>what is covariance?</strong></p>
<p>Recall that a variable’s variance (<span class="math inline">\(\sigma^2_y\)</span>) is the mean of squared deviations from <span class="math inline">\(\bar{y}\)</span>, which quantifies how individual scores vary:</p>
<p><span class="math display">\[\text{Var}(y) = \frac{\sum_{i=1}^N (y_i - \bar{y})^2}{N-1} = \frac{\sum_{i=1}^N (y_i - \bar{y})(y_i - \bar{y})}{N-1}\]</span></p>
<p>Covariance (<span class="math inline">\(\sigma_{xy}\)</span>) quantifies how <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are linearly related (<em>co</em>vary means “vary together”).</p>
<p><span class="math display">\[\text{Cov}(x,y) = \frac{\sum_{i=1}^N (x_i - \bar{x})(y_i - \bar{y})}{N-1}\]</span></p>
<p>Thus, a variance can be seen as a special case of covariance, when <span class="math inline">\(x=y\)</span>.</p>
<p>Its absolute value is difficult to interpret because it is in a squared metric. For a variance, we usually overcome this limitation by interpreting its square-root: the standard deviation (<span class="math inline">\(\sigma\)</span>, or sample estimate <em>SD</em>), expressed in the original units of measurement. In contrast, the square-root of a <em>co</em>variance does not have a meaningful or practical interpretation.</p>
<p>However, the covariance between 2 variables cannot exceed the product of their <em>SD</em>s (<span class="math inline">\(\pm \sigma_x \sigma_y\)</span>), so we can standardize a covariance via division of <span class="math inline">\(\sigma_{xy}\)</span> by <span class="math inline">\(\sigma_x \sigma_y\)</span>. This limits the range to <span class="math inline">\(\pm 1\)</span>, and we call the standardized covariance a <em>correlation coefficient</em>:</p>
<p><span class="math display">\[\rho_{xy} = \frac{\sigma_{xy}}{\sigma_x \sigma_y}\]</span></p>
<p>For <span class="math inline">\(&gt;2\)</span> variables in a data set <span class="math inline">\(\mathbf{Y}\)</span>, we can simultaneously calculate all (co)variances using matrix algebra:</p>
<ol style="list-style-type: decimal">
<li>Mean-center the data-matrix
<ul>
<li><span class="math inline">\(\mathbf{Y} - \bar{\mathbf{Y}}\)</span></li>
</ul></li>
<li>“Square” it by (pre)multiplying it by its transpose</li>
<li>Divide the result by (1 minus) the sample size</li>
</ol>
<p><span class="math display">\[\Sigma = \frac{1}{N-1} (\mathbf{Y} - \bar{\mathbf{Y}})^{&#39;} (\mathbf{Y} - \bar{\mathbf{Y}})\]</span></p>
<p>Each off-diagonal cell of <span class="math inline">\(\Sigma\)</span> contains the covariance between the row-variable and the column-variable. A covariance matrix is symmetric above/below the diagonal because the covariance (or correlation) between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is the same as between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>. On the diagonal of <span class="math inline">\(\Sigma\)</span>, the row and column variables are the same—how does a variable covary with itself? The diagonal contains each variable’s variance. Some authors refer to <span class="math inline">\(\Sigma\)</span> as a “variance–covariance matrix”, but that is redundant because variances appear on the diagonal by definition (see Cov(<span class="math inline">\(x,y\)</span>) formula above). So the term “covariance matrix” is sufficiently descriptive.</p>
<p>Standardizing a covariance (i.e., scaling by both <em>SD</em>s) is only one way to facilitate its interpretation. If it makes sense to think of one variable <span class="math inline">\(x\)</span> affecting another variable <span class="math inline">\(y\)</span>, then another way to scale the covariance would be to divide by variance of <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[\beta_{yx} = \frac{\sigma_{xy}}{\sigma^2_x} = \frac{\sigma_{xy}}{\sigma_x \sigma_x}\]</span></p>
<p>This provides a familiar interpretation from simple regression of <span class="math inline">\(y\)</span> on <span class="math inline">\(x\)</span>: the slope (<span class="math inline">\(\beta_{yx}\)</span>) is interpreted as the change in <span class="math inline">\(y\)</span> per unit <span class="math inline">\(x\)</span>.
Recall that a standardized simple regression slope (<span class="math inline">\(\beta^*_{yx}\)</span>) is the correlation <span class="math inline">\(\rho_{xy}\)</span>. The transformation below reveals why:</p>
<span class="math display">\[\begin{align*}
\beta^*_{yx} &amp;= \beta_{yx} \times \frac{\sigma_x}{\sigma_y} \\
&amp;= \frac{\sigma_{xy}}{\sigma_x \sigma_x} \times \frac{\sigma_x}{\sigma_y} \\
&amp;= \frac{\sigma_{xy}}{\sigma_x \sigma_y} (= \rho_{xy})
\end{align*},\]</span>
<p>where one pair of <span class="math inline">\(\sigma_x\)</span> terms cancels out. This transformation is how slopes can be standardized even when there are multiple predictors. Partial regression slopes can also be calculated from summary statistics, but the formulas are more complicated because they take into account how the predictors are related to each other.</p>
<p>The take-home message is that (un)standardized slopes and (zero-order or partial) correlations are just different ways of scaling a covariance to make it more interpretable. Like covariances, correlations are agnostic about whether one variable affects another, but slopes imply a causal direction (although other conditions must be met to draw a valid causal inference).</p>
</div>
</div>
<div id="importing-data-for-sem" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Importing Data for SEM<a href="ch1.html#importing-data-for-sem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section covers importing both raw data and summary statistics, either of which can be analyzed by SEM software. We will utilize some special features in the open-source R package for SEM called <a href="https://lavaan.ugent.be/"><code>lavaan</code></a> <a href="http://dx.doi.org/10.18637/jss.v048.i02">(Rosseel, 2012)</a>, which is also the primary software we use for conducting SEM analyses in later chapters.</p>
<div id="installing-lavaan" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Installing <code>lavaan</code><a href="ch1.html#installing-lavaan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To install the <code>lavaan</code> package you can type the following command in the R console:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="ch1.html#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;lavaan&quot;</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Depending on your <a href="https://www.r-project.org/">R</a>(<a href="https://www.rstudio.com/">Studio</a>) settings, this might open a window where you have to select a <a href="https://cran.r-project.org/">CRAN</a> mirror (select “[your country], [closest city]”) prior to installing the package, including all additional packages that it depends on. You only need to install the package once (on a specific computer), but you must also “load” the library to access its functionality (similar to first installing an app, then opening the app to use it):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="ch1.html#cb2-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code></pre></div>
<p>Every time you start R you need to use this command to activate the <code>lavaan</code> package into the current R workspace. Therefore, it is advisable to start every script with this command.</p>
<p>Sometimes, it will be necessary to install the <em>development version</em> of <code>lavaan</code> before the next version is made available on CRAN. For example, if the developer has fixed a bug or introduced a new feature in the source code (hosted on <a href="https://github.com/yrosseel/lavaan/">GitHub</a>), the development version can be installed using the <code>remotes</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="ch1.html#cb3-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;remotes&quot;</span>) <span class="co"># if necessary</span></span>
<span id="cb3-2"><a href="ch1.html#cb3-2" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;yrosseel/lavaan&quot;</span>)</span></code></pre></div>
</div>
<div id="importing-raw-data" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Importing Raw Data<a href="ch1.html#importing-raw-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Typically, data are already stored in an external file with a predefined format, such as SPSS (*.sav) or Excel (*.xlsx), and there are some pre-specified functions in R that can read in data from such type of formats, although they require the installation of specific packages. As an alternative, you can store the data in a plain text (with .txt or .csv extensions), where each line represents the observed responses of one individual. Spaces, commas, semicolons or tabs can be used to separate the individual responses. Some programs (like SPSS) can also export data to these types of file formats.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="ch1.html#cb4-1" tabindex="-1"></a><span class="fu">read.table</span>(<span class="st">&quot;data.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href="ch1.html#cb4-2" tabindex="-1"></a><span class="fu">read.spss</span>(<span class="st">&quot;data.sav&quot;</span>, <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>) <span class="co"># requires the package foreign</span></span>
<span id="cb4-3"><a href="ch1.html#cb4-3" tabindex="-1"></a><span class="fu">read.xls</span>(<span class="st">&quot;data.xls&quot;</span>)    <span class="co"># requires the package gdata</span></span>
<span id="cb4-4"><a href="ch1.html#cb4-4" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="st">&quot;data.xlsx&quot;</span>))  <span class="co"># requires the package readxl</span></span></code></pre></div>
<p>This chapter uses data from a tutorial published on the <a href="http://www.socialchangelab.net/uploads/9/8/7/7/98771854/moderated_mediation_example_write-up.pdf">Social Change Lab’s web site</a>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="ch1.html#cb5-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> foreign<span class="sc">::</span><span class="fu">read.spss</span>(<span class="st">&quot;demoData/MODMED.sav&quot;</span>, <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>)[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)]</span>
<span id="cb5-2"><a href="ch1.html#cb5-2" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##   MOOD      NFC      POS      ATT
## 1   -1  3.07579   6.2500  18.5455
## 2   -1  2.59489  -5.0671 -16.9684
## 3   -1 -1.00952   0.9346  -5.9578
## 4   -1 -0.43824   2.8668  -7.2256
## 5   -1  0.21788 -16.5601 -26.7000
## 6   -1  0.43842 -13.1365 -24.1241</code></pre>
<p><code>MOOD</code> indicates experimental conditions</p>
<ul>
<li><span class="math inline">\(+1\)</span> = positive mood induction</li>
<li><span class="math inline">\(-1\)</span> = neutral mood (control condition)</li>
</ul>
<p><code>NFC</code> = need for cognition, <code>POS</code> = positive thoughts, and <code>ATT</code> = attitude</p>
</div>
<div id="calculate-summary-statistics-from-raw-data" class="section level3 hasAnchor" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Calculate Summary Statistics from Raw Data<a href="ch1.html#calculate-summary-statistics-from-raw-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To report summary statistics of your modeled variables, they can be calculated using the <code>colMeans()</code> function for means, the <code>cov()</code> function for a covariance matrix, and the <code>nrow()</code> function for the sample size</p>
<ul>
<li><em>Note</em>: Counting the number of rows <strong>assumes you have complete data</strong></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="ch1.html#cb7-1" tabindex="-1"></a>(M <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(dat)) <span class="co"># mean vector</span></span></code></pre></div>
<pre><code>##       MOOD        NFC        POS        ATT 
##  0.0000000 -0.0000002  0.0000040  1.9807230</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="ch1.html#cb9-1" tabindex="-1"></a>(S <span class="ot">&lt;-</span> <span class="fu">cov</span>(dat)) <span class="co"># covariance matrix</span></span></code></pre></div>
<pre><code>##             MOOD         NFC        POS        ATT
## MOOD  1.01010101 -0.03243879  4.3546465   6.841187
## NFC  -0.03243879  1.97289018  0.7953901   2.598788
## POS   4.35464646  0.79539011 69.2629723  87.914121
## ATT   6.84118687  2.59878834 87.9141208 282.059756</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="ch1.html#cb11-1" tabindex="-1"></a>(N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat)) <span class="co"># complete-data sample size</span></span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>Covariances are explained in more detail in a later section, but it is sufficient here to understand that the covariance between variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> (i.e., <span class="math inline">\(\sigma_{xy}\)</span>) is their unstandardized correlation coefficient (<span class="math inline">\(r_{xy}\)</span>). That is, a correlation is a covariance between <span class="math inline">\(z\)</span> scores. Because correlations are easier to interpret than covariances, it is common to report the means, <em>SD</em>s, and correlations. Using the <em>SD</em>s, readers can rescale correlations to covariances in the orignal units of measurement (i.e., <span class="math inline">\(\sigma_{xy} = \sigma_x \times \sigma_y \times r_{xy}\)</span>). The <code>cov2cor()</code> function can standardize a covariance matrix, or you can use the <code>cor()</code> function directly.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="ch1.html#cb13-1" tabindex="-1"></a>(SD <span class="ot">&lt;-</span> <span class="fu">sapply</span>(dat, sd))</span></code></pre></div>
<pre><code>##      MOOD       NFC       POS       ATT 
##  1.005038  1.404596  8.322438 16.794635</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="ch1.html#cb15-1" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(S)) <span class="co"># SDs == square-roots of variances </span></span></code></pre></div>
<pre><code>##      MOOD       NFC       POS       ATT 
##  1.005038  1.404596  8.322438 16.794635</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="ch1.html#cb17-1" tabindex="-1"></a><span class="fu">cov2cor</span>(S) <span class="co"># standardize the covariance matrix, or use cor()</span></span></code></pre></div>
<pre><code>##             MOOD         NFC        POS       ATT
## MOOD  1.00000000 -0.02297898 0.52061891 0.4053018
## NFC  -0.02297898  1.00000000 0.06804217 0.1101663
## POS   0.52061891  0.06804217 1.00000000 0.6289810
## ATT   0.40530176  0.11016633 0.62898098 1.0000000</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="ch1.html#cb19-1" tabindex="-1"></a>(R <span class="ot">&lt;-</span> <span class="fu">cor</span>(dat))</span></code></pre></div>
<pre><code>##             MOOD         NFC        POS       ATT
## MOOD  1.00000000 -0.02297898 0.52061891 0.4053018
## NFC  -0.02297898  1.00000000 0.06804217 0.1101663
## POS   0.52061891  0.06804217 1.00000000 0.6289810
## ATT   0.40530176  0.11016633 0.62898098 1.0000000</code></pre>
<p>Because covariance and correlation matrices are symmetric (and diagonal elements of a correlation matrix are 1 by definition), both could be reported in a single table. For example, the upper triangle could be correlations, and the lower triangle (including the diagonal) could be (co)variances.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="ch1.html#cb21-1" tabindex="-1"></a>printS <span class="ot">&lt;-</span> S</span>
<span id="cb21-2"><a href="ch1.html#cb21-2" tabindex="-1"></a>printS[<span class="fu">upper.tri</span>(R)] <span class="ot">&lt;-</span> R[<span class="fu">upper.tri</span>(R)]</span>
<span id="cb21-3"><a href="ch1.html#cb21-3" tabindex="-1"></a>printS <span class="co"># not symmetric, correlations in upper triangle</span></span></code></pre></div>
<pre><code>##             MOOD         NFC         POS         ATT
## MOOD  1.01010101 -0.02297898  0.52061891   0.4053018
## NFC  -0.03243879  1.97289018  0.06804217   0.1101663
## POS   4.35464646  0.79539011 69.26297231   0.6289810
## ATT   6.84118687  2.59878834 87.91412077 282.0597561</code></pre>
<div id="calculate-summary-statistics-for-multiple-groups" class="section level4 hasAnchor" number="1.2.3.1">
<h4><span class="header-section-number">1.2.3.1</span> Calculate Summary Statistics for Multiple Groups<a href="ch1.html#calculate-summary-statistics-for-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In SEM, it is common to estimate model parameters simultaneously in multiple groups (i.e., multigroup SEM or MG-SEM). In our example data, the <code>MOOD</code> variable is a 2-group variable, so we could create a <code>factor</code> from the numeric codes:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="ch1.html#cb23-1" tabindex="-1"></a>dat<span class="sc">$</span>mood.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>MOOD, <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb23-2"><a href="ch1.html#cb23-2" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;positive&quot;</span>))</span></code></pre></div>
<p>Then we can calculate the summary statistics separately within each group.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="ch1.html#cb24-1" tabindex="-1"></a>modVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ATT&quot;</span>,<span class="st">&quot;NFC&quot;</span>,<span class="st">&quot;POS&quot;</span>)   <span class="co"># modeled variables</span></span>
<span id="cb24-2"><a href="ch1.html#cb24-2" tabindex="-1"></a>neuRows <span class="ot">&lt;-</span> dat<span class="sc">$</span>mood.f <span class="sc">==</span> <span class="st">&quot;neutral&quot;</span>  <span class="co"># rows for neutral group</span></span>
<span id="cb24-3"><a href="ch1.html#cb24-3" tabindex="-1"></a>posRows <span class="ot">&lt;-</span> dat<span class="sc">$</span>mood.f <span class="sc">==</span> <span class="st">&quot;positive&quot;</span> <span class="co"># rows for positive group</span></span>
<span id="cb24-4"><a href="ch1.html#cb24-4" tabindex="-1"></a>gM <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">neutral  =</span> <span class="fu">colMeans</span>(dat[neuRows, modVars] ),</span>
<span id="cb24-5"><a href="ch1.html#cb24-5" tabindex="-1"></a>           <span class="at">positive =</span> <span class="fu">colMeans</span>(dat[posRows, modVars] ))</span>
<span id="cb24-6"><a href="ch1.html#cb24-6" tabindex="-1"></a>gS <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">neutral  =</span> <span class="fu">cov</span>(     dat[neuRows, modVars] ),</span>
<span id="cb24-7"><a href="ch1.html#cb24-7" tabindex="-1"></a>           <span class="at">positive =</span> <span class="fu">cov</span>(     dat[posRows, modVars] ))</span>
<span id="cb24-8"><a href="ch1.html#cb24-8" tabindex="-1"></a>gN <span class="ot">&lt;-</span> <span class="fu">table</span>(dat<span class="sc">$</span>mood.f)</span></code></pre></div>
<p>To fit a MG-SEM in <code>lavaan</code>, the summary statistics must be a list with one (mean vector or covariance matrix) per group, as well as a vector of group sample sizes.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="ch1.html#cb25-1" tabindex="-1"></a>gM</span></code></pre></div>
<pre><code>## $neutral
##        ATT        NFC        POS 
## -4.7920520  0.0321142 -4.3110960 
## 
## $positive
##        ATT        NFC        POS 
##  8.7534980 -0.0321146  4.3111040</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="ch1.html#cb27-1" tabindex="-1"></a>gS</span></code></pre></div>
<pre><code>## $neutral
##            ATT       NFC       POS
## ATT 245.020884  4.812796 61.799307
## NFC   4.812796  2.456274 -1.201971
## POS  61.799307 -1.201971 47.663230
## 
## $positive
##             ATT       NFC       POS
## ATT 231.2417228 0.8817017 56.235120
## NFC   0.8817017 1.5276643  3.091531
## POS  56.2351197 3.0915313 54.346483</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="ch1.html#cb29-1" tabindex="-1"></a>gN</span></code></pre></div>
<pre><code>## 
##  neutral positive 
##       50       50</code></pre>
</div>
</div>
<div id="importing-summary-data" class="section level3 hasAnchor" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Importing Summary Data<a href="ch1.html#importing-summary-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="full-covariance-matrix" class="section level4 hasAnchor" number="1.2.4.1">
<h4><span class="header-section-number">1.2.4.1</span> Full Covariance Matrix<a href="ch1.html#full-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If we are importing summary data (e.g., from an article that reported them), we can type our data directly to our R script. Suppose the values above from <code>S</code> were rounded to 3 decimal places:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="ch1.html#cb31-1" tabindex="-1"></a>covVals <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fl">1.010</span>, <span class="sc">-</span><span class="fl">0.032</span>,  <span class="fl">4.355</span>,   <span class="fl">6.841</span>, </span>
<span id="cb31-2"><a href="ch1.html#cb31-2" tabindex="-1"></a>             <span class="sc">-</span><span class="fl">0.032</span>,  <span class="fl">1.973</span>,  <span class="fl">0.795</span>,   <span class="fl">2.599</span>, </span>
<span id="cb31-3"><a href="ch1.html#cb31-3" tabindex="-1"></a>              <span class="fl">4.355</span>,  <span class="fl">0.795</span>, <span class="fl">69.263</span>,  <span class="fl">87.914</span>,</span>
<span id="cb31-4"><a href="ch1.html#cb31-4" tabindex="-1"></a>              <span class="fl">6.841</span>,  <span class="fl">2.599</span>, <span class="fl">87.914</span>, <span class="fl">282.060</span>)</span>
<span id="cb31-5"><a href="ch1.html#cb31-5" tabindex="-1"></a>covVals</span></code></pre></div>
<pre><code>##  [1]   1.010  -0.032   4.355   6.841  -0.032   1.973   0.795   2.599   4.355   0.795
## [11]  69.263  87.914   6.841   2.599  87.914 282.060</code></pre>
<p>If these values were saved as plain text, we could also read the data from a file using the <code>scan()</code> function, which returns a vector that contains the stored values in the file <code>"values.txt"</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="ch1.html#cb33-1" tabindex="-1"></a>covVals <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">&quot;values.txt&quot;</span>)</span></code></pre></div>
<p>Either way, we can place these values from the full covariance matrix into a matrix using the <code>matrix()</code> function, specifying how many rows and columns there are:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="ch1.html#cb34-1" tabindex="-1"></a>(newS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> covVals, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>))</span></code></pre></div>
<pre><code>##        [,1]   [,2]   [,3]    [,4]
## [1,]  1.010 -0.032  4.355   6.841
## [2,] -0.032  1.973  0.795   2.599
## [3,]  4.355  0.795 69.263  87.914
## [4,]  6.841  2.599 87.914 282.060</code></pre>
<p>We can give names to the variables in the covariance matrix by using the <code>dimnames=</code> argument of the <code>matrix()</code> function, or by using the <code>dimnames()</code> function after creating the matrix. Let’s save the variable names in an object <code>obsnames</code>, then use them to assign names.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="ch1.html#cb36-1" tabindex="-1"></a>obsnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MOOD&quot;</span>, <span class="st">&quot;NFC&quot;</span>, <span class="st">&quot;POS&quot;</span>, <span class="st">&quot;ATT&quot;</span>)</span>
<span id="cb36-2"><a href="ch1.html#cb36-2" tabindex="-1"></a><span class="do">## providing names when creating matrix</span></span>
<span id="cb36-3"><a href="ch1.html#cb36-3" tabindex="-1"></a>newS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(covVals, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb36-4"><a href="ch1.html#cb36-4" tabindex="-1"></a>               <span class="at">dimnames =</span> <span class="fu">list</span>(obsnames, obsnames))</span>
<span id="cb36-5"><a href="ch1.html#cb36-5" tabindex="-1"></a><span class="do">## or assign afterward, all at once</span></span>
<span id="cb36-6"><a href="ch1.html#cb36-6" tabindex="-1"></a><span class="fu">dimnames</span>(newS) <span class="ot">&lt;-</span> <span class="fu">list</span>(obsnames, obsnames) <span class="co"># (rows, columns)</span></span>
<span id="cb36-7"><a href="ch1.html#cb36-7" tabindex="-1"></a><span class="do">## or one dimension at a time (useful for asymmetric matrix)</span></span>
<span id="cb36-8"><a href="ch1.html#cb36-8" tabindex="-1"></a><span class="fu">rownames</span>(newS) <span class="ot">&lt;-</span> obsnames</span>
<span id="cb36-9"><a href="ch1.html#cb36-9" tabindex="-1"></a><span class="fu">colnames</span>(newS) <span class="ot">&lt;-</span> obsnames</span></code></pre></div>
<div id="rescaling-a-correlation-matrix" class="section level5 hasAnchor" number="1.2.4.1.1">
<h5><span class="header-section-number">1.2.4.1.1</span> Rescaling a Correlation Matrix<a href="ch1.html#rescaling-a-correlation-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>If the imported matrix is instead a full correlation matrix (i.e., assuming all variables have <span class="math inline">\(SD=1\)</span>), then it can be transformed back into a covariance matrix using the <span class="math inline">\(SD\)</span>s, so variables will be in their original units. This is important because an SEM fitted to a correlation matrix will have biased <span class="math inline">\(SE\)</span>s and inflated Type I error rates unless complex constraints are imposed.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="ch1.html#cb37-1" tabindex="-1"></a><span class="do">## store values from correlation matrix</span></span>
<span id="cb37-2"><a href="ch1.html#cb37-2" tabindex="-1"></a>corVals <span class="ot">&lt;-</span> <span class="fu">c</span>(  <span class="dv">1</span>,    <span class="sc">-</span><span class="fl">0.023</span>, <span class="fl">0.521</span>, <span class="fl">0.405</span>,</span>
<span id="cb37-3"><a href="ch1.html#cb37-3" tabindex="-1"></a>              <span class="sc">-</span><span class="fl">0.023</span>, <span class="dv">1</span>,     <span class="fl">0.068</span>, <span class="fl">0.110</span>,</span>
<span id="cb37-4"><a href="ch1.html#cb37-4" tabindex="-1"></a>               <span class="fl">0.521</span>, <span class="fl">0.068</span>, <span class="dv">1</span>,     <span class="fl">0.629</span>, </span>
<span id="cb37-5"><a href="ch1.html#cb37-5" tabindex="-1"></a>               <span class="fl">0.405</span>, <span class="fl">0.110</span>, <span class="fl">0.629</span>, <span class="dv">1</span>)</span>
<span id="cb37-6"><a href="ch1.html#cb37-6" tabindex="-1"></a>newR <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> corVals, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb37-7"><a href="ch1.html#cb37-7" tabindex="-1"></a>               <span class="at">dimnames =</span> <span class="fu">list</span>(obsnames, obsnames))</span>
<span id="cb37-8"><a href="ch1.html#cb37-8" tabindex="-1"></a>newR</span></code></pre></div>
<pre><code>##        MOOD    NFC   POS   ATT
## MOOD  1.000 -0.023 0.521 0.405
## NFC  -0.023  1.000 0.068 0.110
## POS   0.521  0.068 1.000 0.629
## ATT   0.405  0.110 0.629 1.000</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="ch1.html#cb39-1" tabindex="-1"></a><span class="do">## store SDs as a diagonal matrix</span></span>
<span id="cb39-2"><a href="ch1.html#cb39-2" tabindex="-1"></a>(SDs <span class="ot">&lt;-</span> <span class="fu">diag</span>(SD))</span></code></pre></div>
<pre><code>##          [,1]     [,2]     [,3]     [,4]
## [1,] 1.005038 0.000000 0.000000  0.00000
## [2,] 0.000000 1.404596 0.000000  0.00000
## [3,] 0.000000 0.000000 8.322438  0.00000
## [4,] 0.000000 0.000000 0.000000 16.79463</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="ch1.html#cb41-1" tabindex="-1"></a><span class="do">## transform correlations to covariances</span></span>
<span id="cb41-2"><a href="ch1.html#cb41-2" tabindex="-1"></a>scaled.S <span class="ot">&lt;-</span> SDs <span class="sc">%*%</span> newR <span class="sc">%*%</span> SDs</span>
<span id="cb41-3"><a href="ch1.html#cb41-3" tabindex="-1"></a><span class="fu">round</span>(scaled.S, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##        [,1]   [,2]   [,3]    [,4]
## [1,]  1.010 -0.032  4.358   6.836
## [2,] -0.032  1.973  0.795   2.595
## [3,]  4.358  0.795 69.263  87.917
## [4,]  6.836  2.595 87.917 282.060</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="ch1.html#cb43-1" tabindex="-1"></a><span class="do">## matches covariance matrix (within rounding error)</span></span>
<span id="cb43-2"><a href="ch1.html#cb43-2" tabindex="-1"></a>newS</span></code></pre></div>
<pre><code>##        MOOD    NFC    POS     ATT
## MOOD  1.010 -0.032  4.355   6.841
## NFC  -0.032  1.973  0.795   2.599
## POS   4.355  0.795 69.263  87.914
## ATT   6.841  2.599 87.914 282.060</code></pre>
<p>Note that rescaling the correlation matrix to be a covariance matrix required pre- and postmultipication of the (diagnal matrix of) <span class="math inline">\(SD\)</span>s. The operator for matrix multiplication is <code>%*%</code> (the normal scalar multiplication operator <code>*</code> would simply multiply each cell of one matrix with the corresponding cell of another matrix). The table below gives an overview of commonly used functions in matrix algebra in R.</p>
<table>
<thead>
<tr class="header">
<th><strong>Symbol</strong></th>
<th><strong>Function</strong></th>
<th><strong>Example in R</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(A+B\)</span></td>
<td>Addition</td>
<td><code>A + B</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A-B\)</span></td>
<td>Subtraction</td>
<td><code>A - B</code></td>
</tr>
<tr class="odd">
<td>(none)</td>
<td>Elementwise Multiplication (in R)</td>
<td><code>A * B</code></td>
</tr>
<tr class="even">
<td>(none)</td>
<td>Elementwise Division (in R)</td>
<td><code>A / B</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(AB\)</span></td>
<td>Matrix Multiplication</td>
<td><code>A %*% B</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A^{-1}\)</span></td>
<td>Inverse (enables “division” analog)</td>
<td><code>solve(A)</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A^{&#39;}\)</span></td>
<td>Transpose (rows become columns)</td>
<td><code>t(A)</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(|A|\)</span></td>
<td>Determinant (generalized variance)</td>
<td><code>det(A)</code></td>
</tr>
</tbody>
</table>
<p>To review basic matrix algebra, consult a linear algebra text or an appendix of some SEM textbooks (e.g., Bollen, 1989; Schumacker &amp; Lomax, 2016).</p>
</div>
</div>
<div id="upperlower-triangle-of-a-covariance-matrix" class="section level4 hasAnchor" number="1.2.4.2">
<h4><span class="header-section-number">1.2.4.2</span> Upper/Lower Triangle of a Covariance Matrix<a href="ch1.html#upperlower-triangle-of-a-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As a covariance matrix is a symmetric matrix, we do not need to provide the complete matrix. Instead, we can import only the nonredundant information from only the lower (or upper) triangle of the covariance matrix, then use the <code>lavaan</code> function <code>getCov()</code> to create the full matrix. By default, <code>getCov()</code> expects the values from the lower triangle, and it will read values row-by-row (i.e., left-to-right, top-to-bottom), including the diagonal elements (<code>diagonal = TRUE</code> is the default argument).</p>
<p><span class="math display">\[
\begin{bmatrix}
1.010 &amp; &amp; &amp; \\
-0.032 &amp; 1.973 &amp; &amp; \\
4.355 &amp; 0.795 &amp; 69.263 &amp; \\
6.841 &amp; 2.599 &amp; 87.914 &amp; 282.060
\end{bmatrix}
\]</span></p>
<p>This is equivalent to reading the upper triangle column-by-column (i.e., top-to-bottom, left-to-right). One can also add a vector with the <code>names=</code> of the observed variables. It returns the complete covariance matrix, including row and column names. The following code can be used to create a full matrix that is equal to <code>S</code> and <code>newS</code> above, using only the values from the lower triangle of the matrix.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="ch1.html#cb45-1" tabindex="-1"></a>lowerS <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fl">1.010</span>,</span>
<span id="cb45-2"><a href="ch1.html#cb45-2" tabindex="-1"></a>            <span class="sc">-</span><span class="fl">0.032</span>, <span class="fl">1.973</span>, </span>
<span id="cb45-3"><a href="ch1.html#cb45-3" tabindex="-1"></a>             <span class="fl">4.355</span>, <span class="fl">0.795</span>, <span class="fl">69.263</span>, </span>
<span id="cb45-4"><a href="ch1.html#cb45-4" tabindex="-1"></a>             <span class="fl">6.841</span>, <span class="fl">2.599</span>, <span class="fl">87.914</span>, <span class="fl">282.060</span>)</span>
<span id="cb45-5"><a href="ch1.html#cb45-5" tabindex="-1"></a><span class="fu">getCov</span>(<span class="at">x =</span> lowerS, <span class="at">names =</span> obsnames)</span></code></pre></div>
<pre><code>##        MOOD    NFC    POS     ATT
## MOOD  1.010 -0.032  4.355   6.841
## NFC  -0.032  1.973  0.795   2.599
## POS   4.355  0.795 69.263  87.914
## ATT   6.841  2.599 87.914 282.060</code></pre>
<p>Sometimes you will find the upper triangle reported in a published paper instead of the lower triangle. Because <code>getCov()</code> <strong>only reads values row-by-row</strong> (i.e., left-to-right, top-to-bottom), reading an upper-triangle requires changing the argument to <code>lower = FALSE</code>.</p>
<p><span class="math display">\[
\begin{bmatrix}
1.010 &amp; -0.032 &amp;  4.355 &amp;   6.841  \\
      &amp;  1.973 &amp;  0.795 &amp;   2.599  \\
      &amp;        &amp; 69.263 &amp;  87.914  \\
      &amp;        &amp;        &amp; 282.060  
\end{bmatrix}
\]</span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="ch1.html#cb47-1" tabindex="-1"></a>upperS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.010</span>, <span class="sc">-</span><span class="fl">0.032</span>, <span class="fl">4.355</span>,  <span class="fl">6.841</span>, </span>
<span id="cb47-2"><a href="ch1.html#cb47-2" tabindex="-1"></a>                    <span class="fl">1.973</span>, <span class="fl">0.795</span>,  <span class="fl">2.599</span>, </span>
<span id="cb47-3"><a href="ch1.html#cb47-3" tabindex="-1"></a>                          <span class="fl">69.263</span>, <span class="fl">87.914</span>,</span>
<span id="cb47-4"><a href="ch1.html#cb47-4" tabindex="-1"></a>                                 <span class="fl">282.060</span>)</span>
<span id="cb47-5"><a href="ch1.html#cb47-5" tabindex="-1"></a><span class="fu">getCov</span>(<span class="at">x =</span> upperS, <span class="at">names =</span> obsnames, <span class="at">lower =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##        MOOD    NFC    POS     ATT
## MOOD  1.010 -0.032  4.355   6.841
## NFC  -0.032  1.973  0.795   2.599
## POS   4.355  0.795 69.263  87.914
## ATT   6.841  2.599 87.914 282.060</code></pre>
<div id="upperlower-triangle-of-a-correlation-matrix" class="section level5 hasAnchor" number="1.2.4.2.1">
<h5><span class="header-section-number">1.2.4.2.1</span> Upper/Lower Triangle of a Correlation Matrix<a href="ch1.html#upperlower-triangle-of-a-correlation-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Quite frequently, in published papers the covariance matrix is not provided, but instead a correlation matrix and <span class="math inline">\(SD\)</span>s are given separately. The <code>getCov()</code> argument <code>sds=</code> can be used to automatically rescale the correlation matrix. Because the diagonal of a correlation matrix is always 1, it is not necessary to include the diagonal values.</p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; &amp; &amp; \\
-0.023 &amp; 1 &amp; &amp; \\
0.521 &amp; 0.068 &amp; 1 &amp; \\
0.405 &amp; 0.110 &amp; 0.629 &amp; 1
\end{bmatrix}
\]</span></p>
<p>In this case, tell <code>lavaan</code> that the diagonal entries are omitted using the <code>diagonal=FALSE</code> argument. The following syntax creates the complete covariance matrix that was used in the previous examples from the correlations and <span class="math inline">\(SD\)</span>s.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="ch1.html#cb49-1" tabindex="-1"></a><span class="fu">getCov</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.023</span>, <span class="fl">0.521</span>, <span class="fl">0.068</span>, <span class="fl">0.405</span>, <span class="fl">0.110</span>, <span class="fl">0.629</span>),</span>
<span id="cb49-2"><a href="ch1.html#cb49-2" tabindex="-1"></a>       <span class="at">diagonal =</span> <span class="cn">FALSE</span>, <span class="at">sds =</span> SD, <span class="at">names =</span> obsnames)</span></code></pre></div>
<pre><code>##             MOOD         NFC        POS        ATT
## MOOD  1.01010101 -0.03246846  4.3578341   6.836093
## NFC  -0.03246846  1.97289018  0.7948971   2.594865
## POS   4.35783405  0.79489713 69.2629723  87.916779
## ATT   6.83609342  2.59486462 87.9167795 282.059756</code></pre>
<p>If you are wondering whether the correlations appear in the correct order in the matrix, you can first leave the <span class="math inline">\(SD\)</span>s out and check that the cells of the correlation matrix are in the correct order. If everything looks correct, then you can add the <span class="math inline">\(SD\)</span>s. Covariance/correlation matrices are also symmetric, so it is also important to check that the lower triangle is a reflection of the upper triangle (i.e., Row-<span class="math inline">\(x\)</span> Column-<span class="math inline">\(y\)</span> of the matrix should contain the same value as Row-<span class="math inline">\(y\)</span> Column-<span class="math inline">\(x\)</span>). The R function <code>isSymmetric()</code> can perform this check for you:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="ch1.html#cb51-1" tabindex="-1"></a><span class="fu">isSymmetric</span>(S)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
</div>
</div>
<div id="regression-using-matrix-algebra" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Regression Using Matrix Algebra<a href="ch1.html#regression-using-matrix-algebra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section is more technical than most remaining chapters will be. The main goal of this section is to demonstrate how GLM parameters can be estimated using raw data and summary statistics, revealing how these approaches are equivalent. Familiarity with the basics of matrix algebra will continue to remain important throughout later chapters as well, not only because much of SEM is expressed in matrix notation, but because later chapters will demonstrate certain methods (e.g., standardizing an entire matrix of regression slopes) using matrix algebra.</p>
<div id="ch1-3-1" class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Linear Regression Models<a href="ch1.html#ch1-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The GLM expresses an outcome <span class="math inline">\(y\)</span> as a linear combination (weighted sum) of predictors:</p>
<span class="math display">\[\begin{align*}
y_i &amp;= \beta_0 + \beta_1 x_{i1} + \ldots + \beta_p x_{ip} &amp;+&amp; \varepsilon_i \\
    &amp;= \beta_0 + \sum_{j=1}^p \beta_j x_{ij} &amp;+&amp; \varepsilon_i \sim \mathcal{N}(0, \sigma)
\end{align*}\]</span>
<ul>
<li>The <em>deterministic</em> component of <span class="math inline">\(y\)</span> can be predicted or explained by <span class="math inline">\(X\)</span></li>
<li>The <em>stochastic</em> component of <span class="math inline">\(y\)</span> includes all other unmodeled effects (omitted variables) and sources of error (<span class="math inline">\(\varepsilon\)</span>)</li>
</ul>
<p>This is analogous to a recipe for the outcome: How much of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> do you need to recreate <span class="math inline">\(y\)</span>?</p>
<p>The notation above uses a subscript <em>i</em> as an “index variable” for subject <span class="math inline">\(i = 1, \dots, N\)</span>. There are other notations, such as the full matrix notation showing each subject’s values of the outcome <span class="math inline">\(y\)</span> and predictors <span class="math inline">\(j = 1, \dots, p\)</span> in columns of the matrix <span class="math inline">\(\mathbf{X}\)</span>:</p>
<span class="math display">\[\begin{equation*}
  \begin{bmatrix}
    y_1 \\
    y_2 \\
    \vdots \\
    y_N
  \end{bmatrix} =
  \begin{bmatrix}
      1 &amp; x_{1,1} &amp; x_{1,2} &amp; \dots  &amp; x_{1,p} \\
      1 &amp; x_{2,1} &amp; x_{2,2} &amp; \dots  &amp; x_{2,p} \\
\vdots &amp; \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
      1 &amp; x_{N,1} &amp; x_{N,2} &amp; \dots  &amp; x_{N,p}
  \end{bmatrix}
  \begin{bmatrix}
    \beta_0 \\
    \beta_1 \\
    \beta_2 \\
    \vdots \\
    \beta_p
  \end{bmatrix} +
  \begin{bmatrix}
    \varepsilon_1 \\
    \varepsilon_2 \\
    \vdots \\
    \varepsilon_N
  \end{bmatrix}
\end{equation*}\]</span>
<p>The shorthand notation simply uses bolded symbols for the matrices above: <span class="math inline">\(\mathbf{y} = \mathbf{X} \mathbf{\beta} + \mathbf{\varepsilon}\)</span></p>
<p>The ordinary least-squares (OLS) estimator of <span class="math inline">\(\beta\)</span> minimizes the sum of squared residuals (equivalent to maximizing <span class="math inline">\(R^2\)</span>):</p>
<p><span class="math display">\[\beta = (\mathbf{X}^{&#39;} \mathbf{X})^{-1} \mathbf{X}^{&#39;} \mathbf{y}\]</span></p>
<p>The OLS estimator operates on the raw data: the matrix of predictors (<span class="math inline">\(\mathbf{X}\)</span>) and the vector of outcomes (<span class="math inline">\(\mathbf{y}\)</span>). But recall from the previous section that if the data are mean-centered, then <span class="math inline">\(\mathbf{X}^{&#39;} \mathbf{X}\)</span> is the covariance matrix of the predictors. In that case, there would be no vector of ones in the first column of <span class="math inline">\(\mathbf{X}\)</span>, and the first element of <span class="math inline">\(\beta\)</span> (the intercept) can be omitted because it would be zero whenever <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> are mean-centered. The syntax examples below calculate <span class="math inline">\(\mathbf{\Sigma}_\mathbf{X}\)</span> both manually and using the <code>cov()</code> function to demonstrate their equivalence.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="ch1.html#cb53-1" tabindex="-1"></a><span class="do">## Manual calculation</span></span>
<span id="cb53-2"><a href="ch1.html#cb53-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb53-3"><a href="ch1.html#cb53-3" tabindex="-1"></a>Xc <span class="ot">&lt;-</span> <span class="fu">scale</span>(dat[<span class="fu">c</span>(<span class="st">&quot;MOOD&quot;</span>,<span class="st">&quot;NFC&quot;</span>,<span class="st">&quot;POS&quot;</span>)],</span>
<span id="cb53-4"><a href="ch1.html#cb53-4" tabindex="-1"></a>            <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-5"><a href="ch1.html#cb53-5" tabindex="-1"></a><span class="fu">t</span>(Xc) <span class="sc">%*%</span> Xc <span class="sc">/</span> n</span></code></pre></div>
<pre><code>##             MOOD         NFC        POS
## MOOD  1.01010101 -0.03243879  4.3546465
## NFC  -0.03243879  1.97289018  0.7953901
## POS   4.35464646  0.79539011 69.2629723</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="ch1.html#cb55-1" tabindex="-1"></a><span class="do">## Automated function</span></span>
<span id="cb55-2"><a href="ch1.html#cb55-2" tabindex="-1"></a><span class="fu">cov</span>(dat[<span class="fu">c</span>(<span class="st">&quot;MOOD&quot;</span>,<span class="st">&quot;NFC&quot;</span>,<span class="st">&quot;POS&quot;</span>)])</span></code></pre></div>
<pre><code>##             MOOD         NFC        POS
## MOOD  1.01010101 -0.03243879  4.3546465
## NFC  -0.03243879  1.97289018  0.7953901
## POS   4.35464646  0.79539011 69.2629723</code></pre>
<p>Likewise, <span class="math inline">\(\mathbf{X}^{&#39;} \mathbf{y}\)</span> captures the covariances of predictors with the outcome:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="ch1.html#cb57-1" tabindex="-1"></a><span class="do">## Manual calculation</span></span>
<span id="cb57-2"><a href="ch1.html#cb57-2" tabindex="-1"></a><span class="fu">t</span>(Xc) <span class="sc">%*%</span> dat<span class="sc">$</span>ATT  <span class="sc">/</span> n</span></code></pre></div>
<pre><code>##           [,1]
## MOOD  6.841187
## NFC   2.598788
## POS  87.914121</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="ch1.html#cb59-1" tabindex="-1"></a><span class="do">## Automated function</span></span>
<span id="cb59-2"><a href="ch1.html#cb59-2" tabindex="-1"></a><span class="fu">cov</span>(<span class="at">x =</span> dat[<span class="fu">c</span>(<span class="st">&quot;MOOD&quot;</span>,<span class="st">&quot;NFC&quot;</span>,<span class="st">&quot;POS&quot;</span>)],</span>
<span id="cb59-3"><a href="ch1.html#cb59-3" tabindex="-1"></a>    <span class="at">y =</span> dat<span class="sc">$</span>ATT)</span></code></pre></div>
<pre><code>##           [,1]
## MOOD  6.841187
## NFC   2.598788
## POS  87.914121</code></pre>
<p>Thus, even without access to raw data, the OLS estimates of slopes can be obtained using the data’s summary statistics:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="ch1.html#cb61-1" tabindex="-1"></a>Xcov <span class="ot">&lt;-</span> <span class="fu">cov</span>(dat[<span class="fu">c</span>(<span class="st">&quot;MOOD&quot;</span>,<span class="st">&quot;NFC&quot;</span>,<span class="st">&quot;POS&quot;</span>)])</span>
<span id="cb61-2"><a href="ch1.html#cb61-2" tabindex="-1"></a>Xy <span class="ot">&lt;-</span> <span class="fu">cov</span>(<span class="at">x =</span> dat[<span class="fu">c</span>(<span class="st">&quot;MOOD&quot;</span>,<span class="st">&quot;NFC&quot;</span>,<span class="st">&quot;POS&quot;</span>)],</span>
<span id="cb61-3"><a href="ch1.html#cb61-3" tabindex="-1"></a>          <span class="at">y =</span> dat<span class="sc">$</span>ATT)</span>
<span id="cb61-4"><a href="ch1.html#cb61-4" tabindex="-1"></a><span class="fu">solve</span>(Xcov) <span class="sc">%*%</span> Xy <span class="co"># calculate slopes from (co)variances</span></span></code></pre></div>
<pre><code>##           [,1]
## MOOD 1.8839147
## NFC  0.8883671
## POS  1.1406346</code></pre>
<p>These slopes match the estimates from R’s built-in linear-modeling function:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="ch1.html#cb63-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(ATT <span class="sc">~</span> MOOD <span class="sc">+</span> NFC <span class="sc">+</span> POS, <span class="at">data =</span> dat)</span>
<span id="cb63-2"><a href="ch1.html#cb63-2" tabindex="-1"></a><span class="fu">coef</span>(mod)</span></code></pre></div>
<pre><code>## (Intercept)        MOOD         NFC         POS 
##   1.9807186   1.8839147   0.8883671   1.1406346</code></pre>
</div>
<div id="intercepts-and-means" class="section level3 hasAnchor" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Intercepts and Means<a href="ch1.html#intercepts-and-means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>lm()</code> output above also provides an intercept because the data were not centered. In this case, the matrix <span class="math inline">\(X\)</span> includes a constant (all 1s) in the first column, so its covariance matrix no longer resembles the covariance matrix of the predictors alone. However, the covariation among predictors (and outcome) are still captured, and the column of 1s effectively “partials out” the mean from the predictors and outcome.</p>
<p>In the simplest case without any predictors (an intercept-only model), it is easier to see how the vector of 1s captures mean-structure information. Recall the formula for an arithmetic mean is the sum of <span class="math inline">\(y\)</span> scores, divided by the number of <span class="math inline">\(y\)</span> scores: <span class="math inline">\(\bar{y} = \frac{1}{N} \sum y\)</span>. For the intercept-only model, the intercept (<span class="math inline">\(\beta_0\)</span>) is the mean:</p>
<ul>
<li><span class="math inline">\((\mathbf{X}^{&#39;} \mathbf{X})^{-1} = (\mathbf{1}^{&#39;} \mathbf{1})^{-1} = \frac{1}{N}\)</span></li>
<li><span class="math inline">\(\mathbf{X}^{&#39;} \mathbf{y} = \sum y\)</span></li>
</ul>
<p>The syntax example below demonstrates the equivalence:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="ch1.html#cb65-1" tabindex="-1"></a><span class="do">## using matrix algebra</span></span>
<span id="cb65-2"><a href="ch1.html#cb65-2" tabindex="-1"></a>y   <span class="ot">&lt;-</span> dat<span class="sc">$</span>ATT</span>
<span id="cb65-3"><a href="ch1.html#cb65-3" tabindex="-1"></a>ONE <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> <span class="fu">length</span>(y))</span>
<span id="cb65-4"><a href="ch1.html#cb65-4" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(ONE) <span class="sc">%*%</span> ONE) <span class="sc">%*%</span> <span class="fu">t</span>(ONE) <span class="sc">%*%</span> y</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 1.980723</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="ch1.html#cb67-1" tabindex="-1"></a><span class="do">## fitted linear model with only an intercept</span></span>
<span id="cb67-2"><a href="ch1.html#cb67-2" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## (Intercept) 
##    1.980723</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="ch1.html#cb69-1" tabindex="-1"></a><span class="do">## calculate the mean</span></span>
<span id="cb69-2"><a href="ch1.html#cb69-2" tabindex="-1"></a><span class="fu">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 1.980723</code></pre>
<p>Finally, we will apply the OLS formula (<span class="math inline">\(\beta = (\mathbf{X}^{&#39;} \mathbf{X})^{-1} \mathbf{X}^{&#39;} \mathbf{y}\)</span>) to the full model with uncentered raw data (i.e., intercept included):</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="ch1.html#cb71-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span> <span class="ot">=</span> ONE, <span class="co"># first column is constant</span></span>
<span id="cb71-2"><a href="ch1.html#cb71-2" tabindex="-1"></a>           <span class="fu">as.matrix</span>(dat[<span class="fu">c</span>(<span class="st">&quot;MOOD&quot;</span>,<span class="st">&quot;NFC&quot;</span>,<span class="st">&quot;POS&quot;</span>)]))</span>
<span id="cb71-3"><a href="ch1.html#cb71-3" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y <span class="co"># beta</span></span></code></pre></div>
<pre><code>##                  [,1]
## (Intercept) 1.9807186
## MOOD        1.8839147
## NFC         0.8883671
## POS         1.1406346</code></pre>
<p>Which again matches results from the <code>lm()</code> function:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="ch1.html#cb73-1" tabindex="-1"></a><span class="fu">coef</span>(mod)</span></code></pre></div>
<pre><code>## (Intercept)        MOOD         NFC         POS 
##   1.9807186   1.8839147   0.8883671   1.1406346</code></pre>
<p>When we add a predictor to the model, the intercept becomes a conditional mean (i.e., the expected value when each predictor = 0) rather than the “marginal” or “grand” mean.</p>
</div>
<div id="categorical-predictors" class="section level3 hasAnchor" number="1.3.3">
<h3><span class="header-section-number">1.3.3</span> Categorical Predictors<a href="ch1.html#categorical-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall also that groups <span class="math inline">\(g = 1, \ldots, G\)</span> can be represented using numeric codes, very often 1s, such as dummy codes. For example, a dummy code for Group <span class="math inline">\(g\)</span> indicates whether someone belongs to Group <span class="math inline">\(g\)</span> (1) or not (0). Alternative coding strategies include orthogonal contrast codes or effects coding, the latter of which was how our <code>MOOD</code> variable was coded to indicate experimental conditions:</p>
<ul>
<li><span class="math inline">\(+1\)</span> = positive mood induction</li>
<li><span class="math inline">\(-1\)</span> = neutral mood (control condition)</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="ch1.html#cb75-1" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>MOOD)</span></code></pre></div>
<pre><code>## 
## -1  1 
## 50 50</code></pre>
<p>The algebra is identical, capturing how dummy codes covary with each other and with the outcome. However, the set of all <span class="math inline">\(G\)</span> dummy codes would be perfectly multicollinear with the constant used to estimate the intercept (i.e., the column of 1s is exactly equal to the sum of the dummy-coded columns). This is why we typically estimate slopes for <span class="math inline">\(G-1\)</span> dummy codes, treating the last one as the reference group. Thus, each dummy-code’s slope represents how that group’s mean differs from the reference group’s mean.</p>
<div id="regression-with-group-specific-intercepts" class="section level4 hasAnchor" number="1.3.3.1">
<h4><span class="header-section-number">1.3.3.1</span> Regression with Group-Specific Intercepts<a href="ch1.html#regression-with-group-specific-intercepts" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Rather than choosing a baseline group, we can omit the intercept from the model by dropping the vector of 1s from <span class="math inline">\(X\)</span>. This prevents multicollinearity among the dummy codes and the constant, so <code>lm()</code> will include all <span class="math inline">\(G\)</span> dummy codes (not <span class="math inline">\(G-1\)</span>).</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="ch1.html#cb77-1" tabindex="-1"></a>dat<span class="sc">$</span>mood.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>MOOD, <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb77-2"><a href="ch1.html#cb77-2" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;positive&quot;</span>))</span>
<span id="cb77-3"><a href="ch1.html#cb77-3" tabindex="-1"></a><span class="fu">coef</span>( <span class="fu">lm</span>(POS <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> mood.f, <span class="at">data =</span> dat) )</span></code></pre></div>
<pre><code>##  mood.fneutral mood.fpositive 
##      -4.311096       4.311104</code></pre>
<p>Essentially, this model gives each group its own intercept, which is also the group-mean when there are no other predictors in the model</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="ch1.html#cb79-1" tabindex="-1"></a><span class="fu">aggregate</span>(POS <span class="sc">~</span> mood.f, <span class="at">data =</span> dat, <span class="at">FUN =</span> mean)</span></code></pre></div>
<pre><code>##     mood.f       POS
## 1  neutral -4.311096
## 2 positive  4.311104</code></pre>
<p>Later in this course, you will learn about <em>multigroup SEM</em>, which is when the same SEM is fitted separately (but simultaneously) to 2 or more groups. Multigroup SEM is analogously advantageous, but (unlike in the GLM) variances can also differ across groups, so we do not need to assume homoskedasticity when using multigroup SEM.</p>
<p>Slopes can also be estimated separately per group when the intercept is dropped from the model. This is specified by multiplying the predictor by each dummy code.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="ch1.html#cb81-1" tabindex="-1"></a><span class="do">## no &quot;main/simple effect&quot; of NFC without a reference group</span></span>
<span id="cb81-2"><a href="ch1.html#cb81-2" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(POS <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> mood.f <span class="sc">+</span> mood.f<span class="sc">:</span>NFC, <span class="at">data =</span> dat)</span>
<span id="cb81-3"><a href="ch1.html#cb81-3" tabindex="-1"></a><span class="fu">coef</span>(mod1)</span></code></pre></div>
<pre><code>##      mood.fneutral     mood.fpositive  mood.fneutral:NFC mood.fpositive:NFC 
##         -4.2953810          4.3760943         -0.4893472          2.0236980</code></pre>
<p>This is equivalent to estimating the effect of <code>NFC</code> separately in each group.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="ch1.html#cb83-1" tabindex="-1"></a>mod.neu <span class="ot">&lt;-</span> <span class="fu">lm</span>(POS <span class="sc">~</span> NFC, <span class="at">data =</span> dat,</span>
<span id="cb83-2"><a href="ch1.html#cb83-2" tabindex="-1"></a>              <span class="at">subset =</span> dat<span class="sc">$</span>mood.f <span class="sc">==</span> <span class="st">&quot;neutral&quot;</span>)</span>
<span id="cb83-3"><a href="ch1.html#cb83-3" tabindex="-1"></a><span class="fu">coef</span>(mod.neu)</span></code></pre></div>
<pre><code>## (Intercept)         NFC 
##  -4.2953810  -0.4893472</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="ch1.html#cb85-1" tabindex="-1"></a>mod.pos <span class="ot">&lt;-</span> <span class="fu">lm</span>(POS <span class="sc">~</span> NFC, <span class="at">data =</span> dat,</span>
<span id="cb85-2"><a href="ch1.html#cb85-2" tabindex="-1"></a>              <span class="at">subset =</span> dat<span class="sc">$</span>mood.f <span class="sc">==</span> <span class="st">&quot;positive&quot;</span>)</span>
<span id="cb85-3"><a href="ch1.html#cb85-3" tabindex="-1"></a><span class="fu">coef</span>(mod.pos)</span></code></pre></div>
<pre><code>## (Intercept)         NFC 
##    4.376094    2.023698</code></pre>
<p>We will discuss (dis)advantages of the multigroup approach in the following chapter, after introducing regression models as SEM.</p>
</div>
</div>
</div>
<div id="summary" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Summary<a href="ch1.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter introduced the idea of analyzing mean and covariance structures, which partition descriptive statistics (means and (co)variances) into meaningful components. This enables researchers to impose a hypothesized structure on why variables are related to each other. The next chapter will introduce the SEM framework, which was designed for researchers to specify such theoretical structures as statistical models, and fit them to data in order to estimate and test parameters of interest.</p>
</div>
<div id="references" class="section level2 unnumbered hasAnchor">
<h2>References<a href="ch1.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bollen, K. A. (1989). <em>Structural equations with latent variables</em>. Wiley. <a href="https://doi.org/10.1002/9781118619179" class="uri">https://doi.org/10.1002/9781118619179</a></p>
<p>Rosseel, Y. (2012). <code>lavaan</code>: An R package for structural equation modeling. <em>Journal of Statistical Software, 48</em>(2), 1–36. <a href="https://doi.org/10.18637/jss.v048.i02" class="uri">https://doi.org/10.18637/jss.v048.i02</a></p>
<p>Schumacker, R. E., &amp; Lomax, R. G. (2016). <em>A beginner’s guide to structural equation modeling</em> (4th ed.). Lawrence Erlbaum. <a href="https://doi.org/10.4324/9781315749105" class="uri">https://doi.org/10.4324/9781315749105</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
